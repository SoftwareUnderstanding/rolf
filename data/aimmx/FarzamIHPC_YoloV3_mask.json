{
    "visibility": {
        "visibility": "public",
        "license": "Other"
    },
    "name": "Yolo-v4 and Yolo-v3/v2 for Windows and Linux",
    "definition": {
        "code": [
            {
                "type": "repo",
                "repo_type": "github",
                "owner": "FarzamIHPC",
                "owner_type": "User",
                "name": "YoloV3_mask",
                "url": "https://github.com/FarzamIHPC/YoloV3_mask",
                "stars": 0,
                "pushed_at": "2020-08-02 15:31:24+00:00",
                "created_at": "2020-07-28 09:28:49+00:00",
                "language": "Jupyter Notebook",
                "license": "Other",
                "frameworks": []
            },
            {
                "type": "code",
                "name": "CMakeLists.txt",
                "sha": "dc37cb0ab37872e8e0810de12efef35f78fe2d6b",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/CMakeLists.txt"
                    }
                },
                "size": 20573
            },
            {
                "type": "code",
                "name": "Custom_YOLOv4_Darknet.ipynb",
                "sha": "97f4ff517caf0fa6a737788ee2882edd65103ba4",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/Custom_YOLOv4_Darknet.ipynb"
                    }
                },
                "size": 3123390
            },
            {
                "type": "code",
                "name": "DarknetConfig.cmake.in",
                "sha": "c8f4787db55f87b1048426286ee2ca684edcb050",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/DarknetConfig.cmake.in"
                    }
                },
                "size": 1363
            },
            {
                "type": "code",
                "name": "LICENSE",
                "sha": "a50f7d700ba02bfacd50f59b315311cf4d0bbda2",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/LICENSE"
                    }
                },
                "size": 515
            },
            {
                "type": "code",
                "name": "Makefile",
                "sha": "0a6253106688e0ab38f22a4f9e836f882b24e0e1",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/Makefile"
                    }
                },
                "size": 5423
            },
            {
                "type": "code",
                "name": "bad.list",
                "sha": "4ed273b0f313da04556c5a638488fc347b747107",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/bad.list"
                    }
                },
                "size": 16
            },
            {
                "type": "code",
                "name": "bad_label.list",
                "sha": "9d82cd880b8620716778557f5e9717c0bb988b90",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/bad_label.list"
                    }
                },
                "size": 36303
            },
            {
                "type": "code",
                "name": "build.ps1",
                "sha": "f1b7a329a282d07887de102a249ee6a58f9135d0",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/build.ps1"
                    }
                },
                "size": 8285
            },
            {
                "type": "code",
                "name": "build.sh",
                "sha": "dfd5446b47dec059d2d8a3e3831ec95b707e0441",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/build.sh"
                    }
                },
                "size": 2044
            },
            {
                "type": "code",
                "name": "build_log.txt",
                "sha": "05b5668e9c3e94bef2ab091cf31ffe336dc74268",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/build_log.txt"
                    }
                },
                "size": 61182
            },
            {
                "type": "code",
                "name": "chart.png",
                "sha": "6e1d9a02430dba685801908af94342077112d280",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/chart.png"
                    }
                },
                "size": 88314
            },
            {
                "type": "code",
                "name": "chart_yolov3-ambulance-train.png",
                "sha": "03cc6c2d52ff41ed8c289ed6450143878adde147",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/chart_yolov3-ambulance-train.png"
                    }
                },
                "size": 82252
            },
            {
                "type": "code",
                "name": "chart_yolov3-mask-train.png",
                "sha": "6e1d9a02430dba685801908af94342077112d280",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/chart_yolov3-mask-train.png"
                    }
                },
                "size": 88314
            },
            {
                "type": "code",
                "name": "class.names",
                "sha": "4e99a7dac5d205e024f72c0d6c7f879ddfed0f88",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/class.names"
                    }
                },
                "size": 9
            },
            {
                "type": "code",
                "name": "class_mask.names",
                "sha": "f8a243c768c1a9596889b0cf1a6a3d1b6564ea53",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/class_mask.names"
                    }
                },
                "size": 12
            },
            {
                "type": "code",
                "name": "darknet",
                "sha": "abdb07e226199f7ec07c170c2a93bd3349e7b67a",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/darknet"
                    }
                },
                "size": 5532152
            },
            {
                "type": "code",
                "name": "darknet.py",
                "sha": "27a7a6797e6c5ed646a9231a915be430da2e81b7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/darknet.py"
                    }
                },
                "size": 20056
            },
            {
                "type": "code",
                "name": "darknet_video.py",
                "sha": "aa9c669649fd3ca44d97b4e19d05c4655dbcf856",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/darknet_video.py"
                    }
                },
                "size": 4010
            },
            {
                "type": "code",
                "name": "data_test.txt",
                "sha": "cfac4eb0983c18298e398b12fa62a59797c2c7cd",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/data_test.txt"
                    }
                },
                "size": 2336
            },
            {
                "type": "code",
                "name": "data_test_mask.txt",
                "sha": "7af23a3d60e802dcfa7d5b73cb0b8b3b9893681f",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/data_test_mask.txt"
                    }
                },
                "size": 17065
            },
            {
                "type": "code",
                "name": "data_train.txt",
                "sha": "ac273c8178c784cb6e43ab6043f6ebe42a7e3c0f",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/data_train.txt"
                    }
                },
                "size": 8480
            },
            {
                "type": "code",
                "name": "data_train_mask.txt",
                "sha": "1a740167823d5e7c0d010ae307576980a472c29b",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/data_train_mask.txt"
                    }
                },
                "size": 68697
            },
            {
                "type": "code",
                "name": "image_yolov2.sh",
                "sha": "b1d518640a8e48145aa008d8d888caf093d70b69",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/image_yolov2.sh"
                    }
                },
                "size": 108
            },
            {
                "type": "code",
                "name": "image_yolov3.sh",
                "sha": "49cc5eb66db36d7036bbb70388edefc26a3468b8",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/image_yolov3.sh"
                    }
                },
                "size": 110
            },
            {
                "type": "code",
                "name": "json_mjpeg_streams.sh",
                "sha": "0bf180b60bf3e4705e087e0bed68db35d19de244",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/json_mjpeg_streams.sh"
                    }
                },
                "size": 345
            },
            {
                "type": "code",
                "name": "net_cam_v3.sh",
                "sha": "10fbf369a4ead3ee75c66966f4d5453e5794d3aa",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/net_cam_v3.sh"
                    }
                },
                "size": 159
            },
            {
                "type": "code",
                "name": "predictions.jpg",
                "sha": "d51aada4da325a8ac59ab25d932235701dbe3880",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/predictions.jpg"
                    }
                },
                "size": 31070
            },
            {
                "type": "code",
                "name": "test-image1.jpg",
                "sha": "b79fdd109c51b13a50549d091f4668aaaaabd701",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test-image1.jpg"
                    }
                },
                "size": 316127
            },
            {
                "type": "code",
                "name": "test-image2.jpg",
                "sha": "ced21aa0d9d2f4eef175de3f3103e503b298a72d",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test-image2.jpg"
                    }
                },
                "size": 55982
            },
            {
                "type": "code",
                "name": "test-image3.jpg",
                "sha": "ea9f0bb156f98498a9f89ffd9dd44688eba3bf07",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test-image3.jpg"
                    }
                },
                "size": 167065
            },
            {
                "type": "code",
                "name": "test-image4.jpg",
                "sha": "3e245173c8d9531f0a199f4ad3f7a1d00534d2b7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test-image4.jpg"
                    }
                },
                "size": 25272
            },
            {
                "type": "code",
                "name": "test2.jpg",
                "sha": "43fc127c870d157f6df10737d3bf5f8aeab08ee4",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test2.jpg"
                    }
                },
                "size": 31241
            },
            {
                "type": "code",
                "name": "test3.jpg",
                "sha": "2db6452caf81f1bb8ed5041dce3c8b2ff2ec1752",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test3.jpg"
                    }
                },
                "size": 102238
            },
            {
                "type": "code",
                "name": "test4.jpg",
                "sha": "66def6ce4deabd608427163c6d0842c9fa3bd0ba",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/test4.jpg"
                    }
                },
                "size": 294313
            },
            {
                "type": "code",
                "name": "train_log.txt",
                "sha": "f0a39f267a1a75dc4e20aedab8cd5f88794417eb",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/train_log.txt"
                    }
                },
                "size": 13106461
            },
            {
                "type": "code",
                "name": "video_v2.sh",
                "sha": "919c5791c340e215f78aeea9ac33012c1b6bb666",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/video_v2.sh"
                    }
                },
                "size": 108
            },
            {
                "type": "code",
                "name": "video_yolov3.sh",
                "sha": "2d0346acb88d6b4c8ac1e34845c0974ed07333d0",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/video_yolov3.sh"
                    }
                },
                "size": 108
            },
            {
                "type": "code",
                "name": "yolov3-mask-setup.data",
                "sha": "9c78ab6d3ebf16a2dac08ce53239cf8e0337c4c2",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov3-mask-setup.data"
                    }
                },
                "size": 110
            },
            {
                "type": "code",
                "name": "yolov3-mask-test.cfg",
                "sha": "6262dd4a4e1b832d299b29515ebc58a4ed3bf1d9",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov3-mask-test.cfg"
                    }
                },
                "size": 8445
            },
            {
                "type": "code",
                "name": "yolov3-mask-train.cfg",
                "sha": "1ae7a40d0873bbea2fdf5388ac7200a76633ffe7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov3-mask-train.cfg"
                    }
                },
                "size": 8444
            },
            {
                "type": "code",
                "name": "yolov4-mask-setup.data",
                "sha": "9c78ab6d3ebf16a2dac08ce53239cf8e0337c4c2",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov4-mask-setup.data"
                    }
                },
                "size": 110
            },
            {
                "type": "code",
                "name": "yolov4-mask-test.cfg",
                "sha": "6262dd4a4e1b832d299b29515ebc58a4ed3bf1d9",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov4-mask-test.cfg"
                    }
                },
                "size": 8445
            },
            {
                "type": "code",
                "name": "yolov4-mask-train.cfg",
                "sha": "8b41f05095af8feadf51f0a61b0455dda32cce6e",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/FarzamIHPC/YoloV3_mask/blob/master/yolov4-mask-train.cfg"
                    }
                },
                "size": 8450
            }
        ]
    },
    "authors": [
        {
            "name": "FarzamIHPC",
            "github_id": "FarzamIHPC"
        }
    ],
    "tags": [],
    "extraction": [
        {
            "type": "github",
            "url": "https://github.com/FarzamIHPC/YoloV3_mask",
            "stars": 0,
            "issues": true,
            "readme": "# Yolo-v4 and Yolo-v3/v2 for Windows and Linux\n### (neural network for object detection) - Tensor Cores can be used on [Linux](https://github.com/AlexeyAB/darknet#how-to-compile-on-linux) and [Windows](https://github.com/AlexeyAB/darknet#how-to-compile-on-windows-using-cmake-gui)\n\nPaper Yolo v4: https://arxiv.org/abs/2004.10934\n\nMore details: [medium link](https://medium.com/@alexeyab84/yolov4-the-most-accurate-real-time-neural-network-on-ms-coco-dataset-73adfd3602fe?source=friends_link&sk=6039748846bbcf1d960c3061542591d7)\n\nDiscussion: [Reddit](https://www.reddit.com/r/MachineLearning/comments/gydxzd/p_yolov4_the_most_accurate_realtime_neural/)\n\nAbout Darknet framework: http://pjreddie.com/darknet/\n\n[![Darknet Continuous Integration](https://github.com/AlexeyAB/darknet/workflows/Darknet%20Continuous%20Integration/badge.svg)](https://github.com/AlexeyAB/darknet/actions?query=workflow%3A%22Darknet+Continuous+Integration%22)\n[![CircleCI](https://circleci.com/gh/AlexeyAB/darknet.svg?style=svg)](https://circleci.com/gh/AlexeyAB/darknet)\n[![TravisCI](https://travis-ci.org/AlexeyAB/darknet.svg?branch=master)](https://travis-ci.org/AlexeyAB/darknet)\n[![Contributors](https://img.shields.io/github/contributors/AlexeyAB/Darknet.svg)](https://github.com/AlexeyAB/darknet/graphs/contributors)\n[![License: Unlicense](https://img.shields.io/badge/license-Unlicense-blue.svg)](https://github.com/AlexeyAB/darknet/blob/master/LICENSE)\n[![DOI](https://zenodo.org/badge/75388965.svg)](https://zenodo.org/badge/latestdoi/75388965)\n[![arxiv.org](http://img.shields.io/badge/cs.CV-arXiv%3A2004.10934-B31B1B.svg)](https://arxiv.org/abs/2004.10934)\n[![colab](https://user-images.githubusercontent.com/4096485/85883812-41a84b00-b7ea-11ea-9559-a147cc410d61.png)](https://colab.research.google.com/drive/12QusaaRj_lUwCGDvQNfICpa7kA7_a2dE)\n\n\n* [YOLOv4 model zoo](https://github.com/AlexeyAB/darknet/wiki/YOLOv4-model-zoo)\n* [Requirements (and how to install dependecies)](#requirements)\n* [Pre-trained models](#pre-trained-models)\n* [FAQ - frequently asked questions](https://github.com/AlexeyAB/darknet/wiki/FAQ---frequently-asked-questions)\n* [Explanations in issues](https://github.com/AlexeyAB/darknet/issues?q=is%3Aopen+is%3Aissue+label%3AExplanations)\n* [Yolo v4 in other frameworks (TensorRT, TensorFlow, PyTorch, OpenVINO, OpenCV-dnn, TVM,...)](#yolo-v4-in-other-frameworks)\n* [Datasets](#datasets)\n\n0.  [Improvements in this repository](#improvements-in-this-repository)\n1.  [How to use](#how-to-use-on-the-command-line)\n2.  How to compile on Linux\n    * [Using cmake](#how-to-compile-on-linux-using-cmake)\n    * [Using make](#how-to-compile-on-linux-using-make)\n3.  How to compile on Windows\n    * [Using CMake-GUI](#how-to-compile-on-windows-using-cmake)\n    * [Using vcpkg](#how-to-compile-on-windows-using-vcpkg)\n    * [Legacy way](#how-to-compile-on-windows-legacy-way)\n4.  [Training and Evaluation of speed and accuracy on MS COCO](https://github.com/AlexeyAB/darknet/wiki#training-and-evaluation-of-speed-and-accuracy-on-ms-coco)\n5.  [How to train with multi-GPU:](#how-to-train-with-multi-gpu)\n6.  [How to train (to detect your custom objects)](#how-to-train-to-detect-your-custom-objects)\n7.  [How to train tiny-yolo (to detect your custom objects)](#how-to-train-tiny-yolo-to-detect-your-custom-objects)\n8.  [When should I stop training](#when-should-i-stop-training)\n9.  [How to improve object detection](#how-to-improve-object-detection)\n10.  [How to mark bounded boxes of objects and create annotation files](#how-to-mark-bounded-boxes-of-objects-and-create-annotation-files)\n11. [How to use Yolo as DLL and SO libraries](#how-to-use-yolo-as-dll-and-so-libraries)\n\n\n\n|  ![Darknet Logo](http://pjreddie.com/media/files/darknet-black-small.png) | &nbsp; ![modern_gpus](https://user-images.githubusercontent.com/4096485/82835867-f1c62380-9ecd-11ea-9134-1598ed2abc4b.png) AP50:95 / AP50 - FPS (Tesla V100) Paper: https://arxiv.org/abs/2004.10934 |\n|---|---|\n\ntkDNN-TensorRT accelerates YOLOv4 **~2x** times for batch=1 and **3x-4x** times for batch=4.\nOpenCV-dnn is ~10% slower than tkDNN-TensorRT.\n* tkDNN: https://github.com/ceccocats/tkDNN\n* OpenCV: https://gist.github.com/YashasSamaga/48bdb167303e10f4d07b754888ddbdcf\n\n**GeForce RTX 2080 Ti:**\n| Network Size \t| Darknet, FPS (avg)| tkDNN TensorRT FP32, FPS  | tkDNN TensorRT FP16, FPS  | OpenCV FP16, FPS | tkDNN TensorRT FP16 batch=4, FPS  | OpenCV FP16 batch=4, FPS | tkDNN Speedup |\n|:-----:|:--------:|--------:|--------:|--------:|--------:|--------:|------:|\n|320\t| 100 | 116 | **202** | 171 | **423** | 384 | **4.2x** |\n|416\t| 82 | 103 | **162** | 146 | **284** | 260 | **3.5x** |\n|512\t| 69 | 91 | **134** | 125 | **206** | 190 | **2.9x** |\n|608 \t| 53 | 62 | **103** | 100 | **150** | 133 | **2.8x**  |\n\n* Yolo v4 Full comparison: [map_fps](https://user-images.githubusercontent.com/4096485/80283279-0e303e00-871f-11ea-814c-870967d77fd1.png)\n* Yolo v4 tiny comparison: [tiny_fps](https://user-images.githubusercontent.com/4096485/85734112-6e366700-b705-11ea-95d1-fcba0de76d72.png)\n* CSPNet: [paper](https://arxiv.org/abs/1911.11929) and [map_fps](https://user-images.githubusercontent.com/4096485/71702416-6645dc00-2de0-11ea-8d65-de7d4b604021.png) comparison: https://github.com/WongKinYiu/CrossStagePartialNetworks\n* Yolo v3 on MS COCO: [Speed / Accuracy (mAP@0.5) chart](https://user-images.githubusercontent.com/4096485/52151356-e5d4a380-2683-11e9-9d7d-ac7bc192c477.jpg)\n* Yolo v3 on MS COCO (Yolo v3 vs RetinaNet) - Figure 3: https://arxiv.org/pdf/1804.02767v1.pdf\n* Yolo v2 on Pascal VOC 2007: https://hsto.org/files/a24/21e/068/a2421e0689fb43f08584de9d44c2215f.jpg\n* Yolo v2 on Pascal VOC 2012 (comp4): https://hsto.org/files/3a6/fdf/b53/3a6fdfb533f34cee9b52bdd9bb0b19d9.jpg\n\n#### Youtube video of results\n\n[![Yolo v4](http://img.youtube.com/vi/1_SiUOYUoOI/0.jpg)](https://youtu.be/1_SiUOYUoOI \"Yolo v4\")\n\nOthers: https://www.youtube.com/user/pjreddie/videos\n\n#### How to evaluate AP of YOLOv4 on the MS COCO evaluation server\n\n1. Download and unzip test-dev2017 dataset from MS COCO server: http://images.cocodataset.org/zips/test2017.zip\n2. Download list of images for Detection taks and replace the paths with yours: https://raw.githubusercontent.com/AlexeyAB/darknet/master/scripts/testdev2017.txt\n3. Download `yolov4.weights` file: https://drive.google.com/open?id=1cewMfusmPjYWbrnuJRuKhPMwRe_b9PaT\n4. Content of the file `cfg/coco.data` should be\n```\nclasses= 80\ntrain  = <replace with your path>/trainvalno5k.txt\nvalid = <replace with your path>/testdev2017.txt\nnames = data/coco.names\nbackup = backup\neval=coco\n```\n5. Create `/results/` folder near with `./darknet` executable file\n6. Run validation: `./darknet detector valid cfg/coco.data cfg/yolov4.cfg yolov4.weights`\n7. Rename the file  `/results/coco_results.json` to `detections_test-dev2017_yolov4_results.json` and compress it to `detections_test-dev2017_yolov4_results.zip`\n8. Submit file `detections_test-dev2017_yolov4_results.zip` to the MS COCO evaluation server for the `test-dev2019 (bbox)`\n\n#### How to evaluate FPS of YOLOv4 on GPU\n\n1. Compile Darknet with `GPU=1 CUDNN=1 CUDNN_HALF=1 OPENCV=1` in the `Makefile` (or use the same settings with Cmake)\n2. Download `yolov4.weights` file 245 MB: [yolov4.weights](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights) (Google-drive mirror [yolov4.weights](https://drive.google.com/open?id=1cewMfusmPjYWbrnuJRuKhPMwRe_b9PaT) )\n3. Get any .avi/.mp4 video file (preferably not more than 1920x1080 to avoid bottlenecks in CPU performance)\n4. Run one of two commands and look at the AVG FPS:\n* include video_capturing + NMS + drawing_bboxes: \n    `./darknet detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights test.mp4 -dont_show -ext_output`\n* exclude video_capturing + NMS + drawing_bboxes: \n    `./darknet detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights test.mp4 -benchmark`\n\n#### Pre-trained models\n\nThere are weights-file for different cfg-files (trained for MS COCO dataset):\n\nFPS on RTX 2070 (R) and Tesla V100 (V):\n\n* [yolov4.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4.cfg) - 245 MB: [yolov4.weights](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights) (Google-drive mirror [yolov4.weights](https://drive.google.com/open?id=1cewMfusmPjYWbrnuJRuKhPMwRe_b9PaT) ) paper [Yolo v4](https://arxiv.org/abs/2004.10934)\n    just change `width=` and `height=` parameters in `yolov4.cfg` file and use the same `yolov4.weights` file for all cases:\n    * `width=608 height=608` in cfg: **65.7% mAP@0.5 (43.5% AP@0.5:0.95) - 34(R) FPS / 62(V) FPS** - 128.5 BFlops\n    * `width=512 height=512` in cfg: **64.9% mAP@0.5 (43.0% AP@0.5:0.95) - 45(R) FPS / 83(V) FPS** - 91.1 BFlops\n    * `width=416 height=416` in cfg: **62.8% mAP@0.5 (41.2% AP@0.5:0.95) - 55(R) FPS / 96(V) FPS** - 60.1 BFlops\n    * `width=320 height=320` in cfg:   **60% mAP@0.5 (  38% AP@0.5:0.95) - 63(R) FPS / 123(V) FPS** - 35.5 BFlops\n\n* [yolov4-tiny.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4-tiny.cfg) - **40.2% mAP@0.5 - 371(1080Ti) FPS / 330(RTX2070) FPS** - 6.9 BFlops - 23.1 MB: [yolov4-tiny.weights](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v4_pre/yolov4-tiny.weights)\n\n* [enet-coco.cfg (EfficientNetB0-Yolov3)](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/enet-coco.cfg) - **45.5% mAP@0.5 - 55(R) FPS** - 3.7 BFlops - 18.3 MB: [enetb0-coco_final.weights](https://drive.google.com/file/d/1FlHeQjWEQVJt0ay1PVsiuuMzmtNyv36m/view)\n\n* [yolov3-openimages.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-openimages.cfg) - 247 MB - 18(R) FPS - OpenImages dataset: [yolov3-openimages.weights](https://pjreddie.com/media/files/yolov3-openimages.weights)\n\n<details><summary><b>CLICK ME</b> - Yolo v3 models</summary>\n\n* [csresnext50-panet-spp-original-optimal.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/csresnext50-panet-spp-original-optimal.cfg) - **65.4% mAP@0.5 (43.2% AP@0.5:0.95) - 32(R) FPS** - 100.5 BFlops - 217 MB: [csresnext50-panet-spp-original-optimal_final.weights](https://drive.google.com/open?id=1_NnfVgj0EDtb_WLNoXV8Mo7WKgwdYZCc)\n\n* [yolov3-spp.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-spp.cfg) - **60.6% mAP@0.5 - 38(R) FPS** - 141.5 BFlops - 240 MB: [yolov3-spp.weights](https://pjreddie.com/media/files/yolov3-spp.weights)\n\n* [csresnext50-panet-spp.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/csresnext50-panet-spp.cfg) - **60.0% mAP@0.5 - 44 FPS** - 71.3 BFlops - 217 MB: [csresnext50-panet-spp_final.weights](https://drive.google.com/file/d/1aNXdM8qVy11nqTcd2oaVB3mf7ckr258-/view?usp=sharing)\n\n* [yolov3.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3.cfg) - **55.3% mAP@0.5 - 66(R) FPS** - 65.9 BFlops - 236 MB: [yolov3.weights](https://pjreddie.com/media/files/yolov3.weights)\n\n* [yolov3-tiny.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-tiny.cfg) - **33.1% mAP@0.5 - 345(R) FPS** - 5.6 BFlops - 33.7 MB: [yolov3-tiny.weights](https://pjreddie.com/media/files/yolov3-tiny.weights)\n\n* [yolov3-tiny-prn.cfg](https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-tiny-prn.cfg) - **33.1% mAP@0.5 - 370(R) FPS** - 3.5 BFlops - 18.8 MB: [yolov3-tiny-prn.weights](https://drive.google.com/file/d/18yYZWyKbo4XSDVyztmsEcF9B_6bxrhUY/view?usp=sharing)\n\n</details>\n\n<details><summary><b>CLICK ME</b> - Yolo v2 models</summary>\n\n* `yolov2.cfg` (194 MB COCO Yolo v2) - requires 4 GB GPU-RAM: https://pjreddie.com/media/files/yolov2.weights\n* `yolo-voc.cfg` (194 MB VOC Yolo v2) - requires 4 GB GPU-RAM: http://pjreddie.com/media/files/yolo-voc.weights\n* `yolov2-tiny.cfg` (43 MB COCO Yolo v2) - requires 1 GB GPU-RAM: https://pjreddie.com/media/files/yolov2-tiny.weights\n* `yolov2-tiny-voc.cfg` (60 MB VOC Yolo v2) - requires 1 GB GPU-RAM: http://pjreddie.com/media/files/yolov2-tiny-voc.weights\n* `yolo9000.cfg` (186 MB Yolo9000-model) - requires 4 GB GPU-RAM: http://pjreddie.com/media/files/yolo9000.weights\n\n</details>\n\nPut it near compiled: darknet.exe\n\nYou can get cfg-files by path: `darknet/cfg/`\n\n### Requirements\n\n* Windows or Linux\n* **CMake >= 3.12**: https://cmake.org/download/\n* **CUDA 10.0**: https://developer.nvidia.com/cuda-toolkit-archive (on Linux do [Post-installation Actions](https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#post-installation-actions))\n* **OpenCV >= 2.4**: use your preferred package manager (brew, apt), build from source using [vcpkg](https://github.com/Microsoft/vcpkg) or download from [OpenCV official site](https://opencv.org/releases.html) (on Windows set system variable `OpenCV_DIR` = `C:\\opencv\\build` - where are the `include` and `x64` folders [image](https://user-images.githubusercontent.com/4096485/53249516-5130f480-36c9-11e9-8238-a6e82e48c6f2.png))\n* **cuDNN >= 7.0 for CUDA 10.0** https://developer.nvidia.com/rdp/cudnn-archive (on **Linux** copy `cudnn.h`,`libcudnn.so`... as desribed here https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installlinux-tar , on **Windows** copy `cudnn.h`,`cudnn64_7.dll`, `cudnn64_7.lib` as desribed here https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installwindows )\n* **GPU with CC >= 3.0**: https://en.wikipedia.org/wiki/CUDA#GPUs_supported\n* on Linux **GCC or Clang**, on Windows **MSVC 2015/2017/2019** https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=Community\n\n\n#### Yolo v4 in other frameworks\n\n\n* **TensorFlow:** YOLOv4 on TensorFlow 2.0 / TFlite / Andriod: https://github.com/hunglc007/tensorflow-yolov4-tflite\n    For YOLOv3 - convert `yolov3.weights`/`cfg` files to `yolov3.ckpt`/`pb/meta`: by using [mystic123](https://github.com/mystic123/tensorflow-yolo-v3) project, and [TensorFlow-lite](https://www.tensorflow.org/lite/guide/get_started#2_convert_the_model_format)\n* **OpenCV-dnn** the fastest implementation of YOLOv4 for CPU (x86/ARM-Android), OpenCV can be compiled with [OpenVINO-backend](https://github.com/opencv/opencv/wiki/Intel's-Deep-Learning-Inference-Engine-backend) for running on (Myriad X / USB Neural Compute Stick / Arria FPGA), use `yolov3.weights`/`cfg` with: [C++ example](https://github.com/opencv/opencv/blob/8c25a8eb7b10fb50cda323ee6bec68aa1a9ce43c/samples/dnn/object_detection.cpp#L192-L221) or [Python example](https://github.com/opencv/opencv/blob/8c25a8eb7b10fb50cda323ee6bec68aa1a9ce43c/samples/dnn/object_detection.py#L129-L150)\n* **Intel OpenVINO 2019 R1:** (Myriad X / USB Neural Compute Stick / Arria FPGA): read this [manual](https://software.intel.com/en-us/articles/OpenVINO-Using-TensorFlow#converting-a-darknet-yolo-model)\n* **Tencent/ncnn:** the fastest inference of YOLOv4 on mobile phone CPU: https://github.com/Tencent/ncnn\n* **PyTorch > ONNX > CoreML > iOS** how to convert cfg/weights-files to pt-file: [ultralytics/yolov3](https://github.com/ultralytics/yolov3#darknet-conversion) and [iOS App](https://itunes.apple.com/app/id1452689527)\n* **TensorRT** YOLOv4 on TensorRT+tkDNN: https://github.com/ceccocats/tkDNN\n    For YOLOv3 (-70% faster inference): [Yolo is natively supported in DeepStream 4.0](https://news.developer.nvidia.com/deepstream-sdk-4-now-available/) read [PDF](https://docs.nvidia.com/metropolis/deepstream/Custom_YOLO_Model_in_the_DeepStream_YOLO_App.pdf). [wang-xinyu/tensorrtx](https://github.com/wang-xinyu/tensorrtx) implemented yolov3-spp, yolov4, etc.\n* **TVM** - compilation of deep learning models (Keras, MXNet, PyTorch, Tensorflow, CoreML, DarkNet) into minimum deployable modules on diverse hardware backends (CPUs, GPUs, FPGA, and specialized accelerators): https://tvm.ai/about\n* **OpenDataCam** - It detects, tracks and counts moving objects by using YOLOv4: https://github.com/opendatacam/opendatacam#-hardware-pre-requisite\n* **Netron** - Visualizer for neural networks: https://github.com/lutzroeder/netron\n\n\n#### Datasets\n\n* MS COCO: use `./scripts/get_coco_dataset.sh` to get labeled MS COCO detection dataset\n* OpenImages: use `python ./scripts/get_openimages_dataset.py` for labeling train detection dataset\n* Pascal VOC: use `python ./scripts/voc_label.py` for labeling Train/Test/Val detection datasets\n* ILSVRC2012 (ImageNet classification): use `./scripts/get_imagenet_train.sh` (also `imagenet_label.sh` for labeling valid set)\n* German/Belgium/Russian/LISA/MASTIF Traffic Sign Datasets for Detection - use this parsers: https://github.com/angeligareta/Datasets2Darknet#detection-task\n* List of other datasets: https://github.com/AlexeyAB/darknet/tree/master/scripts#datasets\n\n\n\n### Improvements in this repository\n\n* developed State-of-the-Art object detector YOLOv4\n* added State-of-Art models: CSP, PRN, EfficientNet\n* added layers: [conv_lstm], [scale_channels] SE/ASFF/BiFPN, [local_avgpool], [sam], [Gaussian_yolo], [reorg3d] (fixed [reorg]), fixed [batchnorm]\n* added the ability for training recurrent models (with layers conv-lstm`[conv_lstm]`/conv-rnn`[crnn]`) for accurate detection on video\n* added data augmentation: `[net] mixup=1 cutmix=1 mosaic=1 blur=1`. Added activations: SWISH, MISH, NORM_CHAN, NORM_CHAN_SOFTMAX\n* added the ability for training with GPU-processing using CPU-RAM to increase the mini_batch_size and increase accuracy (instead of batch-norm sync)\n* improved binary neural network performance **2x-4x times** for Detection on CPU and GPU if you trained your own weights by using this XNOR-net model (bit-1 inference) : https://github.com/AlexeyAB/darknet/blob/master/cfg/yolov3-tiny_xnor.cfg\n* improved neural network performance **~7%** by fusing 2 layers into 1: Convolutional + Batch-norm\n* improved performance: Detection **2x times**, on GPU Volta/Turing (Tesla V100, GeForce RTX, ...) using Tensor Cores if `CUDNN_HALF` defined in the `Makefile` or `darknet.sln`\n* improved performance **~1.2x** times on FullHD, **~2x** times on 4K, for detection on the video (file/stream) using `darknet detector demo`... \n* improved performance **3.5 X times** of data augmentation for training (using OpenCV SSE/AVX functions instead of hand-written functions) - removes bottleneck for training on multi-GPU or GPU Volta\n* improved performance of detection and training on Intel CPU with AVX (Yolo v3 **~85%**)\n* optimized memory allocation during network resizing when `random=1`\n* optimized GPU initialization for detection - we use batch=1 initially instead of re-init with batch=1\n* added correct calculation of **mAP, F1, IoU, Precision-Recall** using command `darknet detector map`...\n* added drawing of chart of average-Loss and accuracy-mAP (`-map` flag) during training\n* run `./darknet detector demo ... -json_port 8070 -mjpeg_port 8090` as JSON and MJPEG server to get results online over the network by using your soft or Web-browser\n* added calculation of anchors for training\n* added example of Detection and Tracking objects: https://github.com/AlexeyAB/darknet/blob/master/src/yolo_console_dll.cpp\n* run-time tips and warnings if you use incorrect cfg-file or dataset\n* added support for Windows\n* many other fixes of code...\n\nAnd added manual - [How to train Yolo v4-v2 (to detect your custom objects)](#how-to-train-to-detect-your-custom-objects)\n\nAlso, you might be interested in using a simplified repository where is implemented INT8-quantization (+30% speedup and -1% mAP reduced): https://github.com/AlexeyAB/yolo2_light\n\n#### How to use on the command line\n\nOn Linux use `./darknet` instead of `darknet.exe`, like this:`./darknet detector test ./cfg/coco.data ./cfg/yolov4.cfg ./yolov4.weights`\n\nOn Linux find executable file `./darknet` in the root directory, while on Windows find it in the directory `\\build\\darknet\\x64` \n\n* Yolo v4 COCO - **image**: `darknet.exe detector test cfg/coco.data cfg/yolov4.cfg yolov4.weights -thresh 0.25`\n* **Output coordinates** of objects: `darknet.exe detector test cfg/coco.data yolov4.cfg yolov4.weights -ext_output dog.jpg`\n* Yolo v4 COCO - **video**: `darknet.exe detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights -ext_output test.mp4`\n* Yolo v4 COCO - **WebCam 0**: `darknet.exe detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights -c 0`\n* Yolo v4 COCO for **net-videocam** - Smart WebCam: `darknet.exe detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights http://192.168.0.80:8080/video?dummy=param.mjpg`\n* Yolo v4 - **save result videofile res.avi**: `darknet.exe detector demo cfg/coco.data cfg/yolov4.cfg yolov4.weights test.mp4 -out_filename res.avi`\n* Yolo v3 **Tiny** COCO - video: `darknet.exe detector demo cfg/coco.data cfg/yolov3-tiny.cfg yolov3-tiny.weights test.mp4`\n* **JSON and MJPEG server** that allows multiple connections from your soft or Web-browser `ip-address:8070` and 8090: `./darknet detector demo ./cfg/coco.data ./cfg/yolov3.cfg ./yolov3.weights test50.mp4 -json_port 8070 -mjpeg_port 8090 -ext_output`\n* Yolo v3 Tiny **on GPU #1**: `darknet.exe detector demo cfg/coco.data cfg/yolov3-tiny.cfg yolov3-tiny.weights -i 1 test.mp4`\n* Alternative method Yolo v3 COCO - image: `darknet.exe detect cfg/yolov4.cfg yolov4.weights -i 0 -thresh 0.25`\n* Train on **Amazon EC2**, to see mAP & Loss-chart using URL like: `http://ec2-35-160-228-91.us-west-2.compute.amazonaws.com:8090` in the Chrome/Firefox (**Darknet should be compiled with OpenCV**): \n    `./darknet detector train cfg/coco.data yolov4.cfg yolov4.conv.137 -dont_show -mjpeg_port 8090 -map`\n* 186 MB Yolo9000 - image: `darknet.exe detector test cfg/combine9k.data cfg/yolo9000.cfg yolo9000.weights`\n* Remeber to put data/9k.tree and data/coco9k.map under the same folder of your app if you use the cpp api to build an app\n* To process a list of images `data/train.txt` and save results of detection to `result.json` file use: \n    `darknet.exe detector test cfg/coco.data cfg/yolov4.cfg yolov4.weights -ext_output -dont_show -out result.json < data/train.txt`\n* To process a list of images `data/train.txt` and save results of detection to `result.txt` use:                             \n    `darknet.exe detector test cfg/coco.data cfg/yolov4.cfg yolov4.weights -dont_show -ext_output < data/train.txt > result.txt`\n* Pseudo-lableing - to process a list of images `data/new_train.txt` and save results of detection in Yolo training format for each image as label `<image_name>.txt` (in this way you can increase the amount of training data) use:\n    `darknet.exe detector test cfg/coco.data cfg/yolov4.cfg yolov4.weights -thresh 0.25 -dont_show -save_labels < data/new_train.txt`\n* To calculate anchors: `darknet.exe detector calc_anchors data/obj.data -num_of_clusters 9 -width 416 -height 416`\n* To check accuracy mAP@IoU=50: `darknet.exe detector map data/obj.data yolo-obj.cfg backup\\yolo-obj_7000.weights`\n* To check accuracy mAP@IoU=75: `darknet.exe detector map data/obj.data yolo-obj.cfg backup\\yolo-obj_7000.weights -iou_thresh 0.75`\n\n##### For using network video-camera mjpeg-stream with any Android smartphone\n\n1. Download for Android phone mjpeg-stream soft: IP Webcam / Smart WebCam\n\n    * Smart WebCam - preferably: https://play.google.com/store/apps/details?id=com.acontech.android.SmartWebCam2\n    * IP Webcam: https://play.google.com/store/apps/details?id=com.pas.webcam\n\n2. Connect your Android phone to computer by WiFi (through a WiFi-router) or USB\n3. Start Smart WebCam on your phone\n4. Replace the address below, on shown in the phone application (Smart WebCam) and launch:\n\n* Yolo v4 COCO-model: `darknet.exe detector demo data/coco.data yolov4.cfg yolov4.weights http://192.168.0.80:8080/video?dummy=param.mjpg -i 0`\n\n### How to compile on Linux (using `cmake`)\n\nThe `CMakeLists.txt` will attempt to find installed optional dependencies like\nCUDA, cudnn, ZED and build against those. It will also create a shared object\nlibrary file to use `darknet` for code development.\n\nOpen a bash terminal inside the cloned repository and launch:\n\n```bash\n./build.sh\n```\n\n### How to compile on Linux (using `make`)\n\nJust do `make` in the darknet directory. (You can try to compile and run it on Google Colab in cloud [link](https://colab.research.google.com/drive/12QusaaRj_lUwCGDvQNfICpa7kA7_a2dE) (press \u00abOpen in Playground\u00bb button at the top-left corner) and watch the video [link](https://www.youtube.com/watch?v=mKAEGSxwOAY) )\nBefore make, you can set such options in the `Makefile`: [link](https://github.com/AlexeyAB/darknet/blob/9c1b9a2cf6363546c152251be578a21f3c3caec6/Makefile#L1)\n\n* `GPU=1` to build with CUDA to accelerate by using GPU (CUDA should be in `/usr/local/cuda`)\n* `CUDNN=1` to build with cuDNN v5-v7 to accelerate training by using GPU (cuDNN should be in `/usr/local/cudnn`)\n* `CUDNN_HALF=1` to build for Tensor Cores (on Titan V / Tesla V100 / DGX-2 and later) speedup Detection 3x, Training 2x\n* `OPENCV=1` to build with OpenCV 4.x/3.x/2.4.x - allows to detect on video files and video streams from network cameras or web-cams\n* `DEBUG=1` to bould debug version of Yolo\n* `OPENMP=1` to build with OpenMP support to accelerate Yolo by using multi-core CPU\n* `LIBSO=1` to build a library `darknet.so` and binary runable file `uselib` that uses this library. Or you can try to run so `LD_LIBRARY_PATH=./:$LD_LIBRARY_PATH ./uselib test.mp4` How to use this SO-library from your own code - you can look at C++ example: https://github.com/AlexeyAB/darknet/blob/master/src/yolo_console_dll.cpp\n    or use in such a way: `LD_LIBRARY_PATH=./:$LD_LIBRARY_PATH ./uselib data/coco.names cfg/yolov4.cfg yolov4.weights test.mp4`\n* `ZED_CAMERA=1` to build a library with ZED-3D-camera support (should be ZED SDK installed), then run\n    `LD_LIBRARY_PATH=./:$LD_LIBRARY_PATH ./uselib data/coco.names cfg/yolov4.cfg yolov4.weights zed_camera`\n\nTo run Darknet on Linux use examples from this article, just use `./darknet` instead of `darknet.exe`, i.e. use this command: `./darknet detector test ./cfg/coco.data ./cfg/yolov4.cfg ./yolov4.weights`\n\n### How to compile on Windows (using `CMake`)\n\nThis is the recommended approach to build Darknet on Windows if you have already\ninstalled Visual Studio 2015/2017/2019, CUDA >= 10.0, cuDNN >= 7.0, and\nOpenCV >= 2.4.\n\nOpen a Powershell terminal inside the cloned repository and launch:\n\n```PowerShell\n.\\build.ps1\n```\n\n### How to compile on Windows (using `vcpkg`)\n\n1. Install or update Visual Studio to at least version 2017, making sure to have it fully patched (run again the installer if not sure to automatically update to latest version). If you need to install from scratch, download VS from here: [Visual Studio Community](http://visualstudio.com)\n\n2. Install CUDA\n\n3. Install [vcpkg](https://github.com/Microsoft/vcpkg) and try to install a test library to make sure everything is working, for example `vcpkg install opengl`\n\n4. Open Powershell and type these commands:\n\n```PowerShell\nPS \\>                  cd vcpkg\nPS Code\\vcpkg>         .\\vcpkg install darknet[full]:x64-windows #replace with darknet[opencv-base,weights]:x64-windows for a quicker install; use --head if you want to build latest commit on master branch and not latest release\n```\n\n5. You will find darknet inside the vcpkg\\installed\\x64-windows\\tools\\darknet folder, together with all the necessary weight and cfg files\n\n### How to compile on Windows (legacy way)\n\n1. If you have **CUDA 10.0, cuDNN 7.4 and OpenCV 3.x** (with paths: `C:\\opencv_3.0\\opencv\\build\\include` & `C:\\opencv_3.0\\opencv\\build\\x64\\vc14\\lib`), then open `build\\darknet\\darknet.sln`, set **x64** and **Release** https://hsto.org/webt/uh/fk/-e/uhfk-eb0q-hwd9hsxhrikbokd6u.jpeg and do the: Build -> Build darknet. Also add Windows system variable `CUDNN` with path to CUDNN: https://user-images.githubusercontent.com/4096485/53249764-019ef880-36ca-11e9-8ffe-d9cf47e7e462.jpg\n\n    1.1. Find files `opencv_world320.dll` and `opencv_ffmpeg320_64.dll` (or `opencv_world340.dll` and `opencv_ffmpeg340_64.dll`) in `C:\\opencv_3.0\\opencv\\build\\x64\\vc14\\bin` and put it near with `darknet.exe`\n    \n    1.2 Check that there are `bin` and `include` folders in the `C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v10.0` if aren't, then copy them to this folder from the path where is CUDA installed\n    \n    1.3. To install CUDNN (speedup neural network), do the following:\n      \n    * download and install **cuDNN v7.4.1 for CUDA 10.0**: https://developer.nvidia.com/rdp/cudnn-archive\n      \n    * add Windows system variable `CUDNN` with path to CUDNN: https://user-images.githubusercontent.com/4096485/53249764-019ef880-36ca-11e9-8ffe-d9cf47e7e462.jpg\n    \n    * copy file `cudnn64_7.dll` to the folder `\\build\\darknet\\x64` near with `darknet.exe`\n    \n    1.4. If you want to build **without CUDNN** then: open `\\darknet.sln` -> (right click on project) -> properties  -> C/C++ -> Preprocessor -> Preprocessor Definitions, and remove this: `CUDNN;`\n\n2. If you have other version of **CUDA (not 10.0)** then open `build\\darknet\\darknet.vcxproj` by using Notepad, find 2 places with \"CUDA 10.0\" and change it to your CUDA-version. Then open `\\darknet.sln` -> (right click on project) -> properties  -> CUDA C/C++ -> Device and remove there `;compute_75,sm_75`. Then do step 1\n\n3. If you **don't have GPU**, but have **OpenCV 3.0** (with paths: `C:\\opencv_3.0\\opencv\\build\\include` & `C:\\opencv_3.0\\opencv\\build\\x64\\vc14\\lib`), then open `build\\darknet\\darknet_no_gpu.sln`, set **x64** and **Release**, and do the: Build -> Build darknet_no_gpu\n\n4. If you have **OpenCV 2.4.13** instead of 3.0 then you should change paths after `\\darknet.sln` is opened\n\n    4.1 (right click on project) -> properties  -> C/C++ -> General -> Additional Include Directories:  `C:\\opencv_2.4.13\\opencv\\build\\include`\n  \n    4.2 (right click on project) -> properties  -> Linker -> General -> Additional Library Directories: `C:\\opencv_2.4.13\\opencv\\build\\x64\\vc14\\lib`\n    \n5. If you have GPU with Tensor Cores (nVidia Titan V / Tesla V100 / DGX-2 and later) speedup Detection 3x, Training 2x:\n    `\\darknet.sln` -> (right click on project) -> properties -> C/C++ -> Preprocessor -> Preprocessor Definitions, and add here: `CUDNN_HALF;`\n    \n    **Note:** CUDA must be installed only after Visual Studio has been installed.\n\n### How to compile (custom):\n\nAlso, you can to create your own `darknet.sln` & `darknet.vcxproj`, this example for CUDA 9.1 and OpenCV 3.0\n\nThen add to your created project:\n- (right click on project) -> properties  -> C/C++ -> General -> Additional Include Directories, put here: \n\n`C:\\opencv_3.0\\opencv\\build\\include;..\\..\\3rdparty\\include;%(AdditionalIncludeDirectories);$(CudaToolkitIncludeDir);$(CUDNN)\\include`\n- (right click on project) -> Build dependecies -> Build Customizations -> set check on CUDA 9.1 or what version you have - for example as here: http://devblogs.nvidia.com/parallelforall/wp-content/uploads/2015/01/VS2013-R-5.jpg\n- add to project:\n    * all `.c` files\n    * all `.cu` files \n    * file `http_stream.cpp` from `\\src` directory\n    * file `darknet.h` from `\\include` directory\n- (right click on project) -> properties  -> Linker -> General -> Additional Library Directories, put here: \n\n`C:\\opencv_3.0\\opencv\\build\\x64\\vc14\\lib;$(CUDA_PATH)\\lib\\$(PlatformName);$(CUDNN)\\lib\\x64;%(AdditionalLibraryDirectories)`\n\n-  (right click on project) -> properties  -> Linker -> Input -> Additional dependecies, put here: \n\n`..\\..\\3rdparty\\lib\\x64\\pthreadVC2.lib;cublas.lib;curand.lib;cudart.lib;cudnn.lib;%(AdditionalDependencies)`\n- (right click on project) -> properties -> C/C++ -> Preprocessor -> Preprocessor Definitions\n\n`OPENCV;_TIMESPEC_DEFINED;_CRT_SECURE_NO_WARNINGS;_CRT_RAND_S;WIN32;NDEBUG;_CONSOLE;_LIB;%(PreprocessorDefinitions)`\n\n- compile to .exe (X64 & Release) and put .dll-s near with .exe: https://hsto.org/webt/uh/fk/-e/uhfk-eb0q-hwd9hsxhrikbokd6u.jpeg\n\n    * `pthreadVC2.dll, pthreadGC2.dll` from \\3rdparty\\dll\\x64\n\n    * `cusolver64_91.dll, curand64_91.dll, cudart64_91.dll, cublas64_91.dll` - 91 for CUDA 9.1 or your version, from C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.1\\bin\n\n    * For OpenCV 3.2: `opencv_world320.dll` and `opencv_ffmpeg320_64.dll` from `C:\\opencv_3.0\\opencv\\build\\x64\\vc14\\bin` \n    * For OpenCV 2.4.13: `opencv_core2413.dll`, `opencv_highgui2413.dll` and `opencv_ffmpeg2413_64.dll` from  `C:\\opencv_2.4.13\\opencv\\build\\x64\\vc14\\bin`\n\n## How to train with multi-GPU:\n\n1. Train it first on 1 GPU for like 1000 iterations: `darknet.exe detector train cfg/coco.data cfg/yolov4.cfg yolov4.conv.137`\n\n2. Then stop and by using partially-trained model `/backup/yolov4_1000.weights` run training with multigpu (up to 4 GPUs): `darknet.exe detector train cfg/coco.data cfg/yolov4.cfg /backup/yolov4_1000.weights -gpus 0,1,2,3`\n\nIf you get a Nan, then for some datasets better to decrease learning rate, for 4 GPUs set `learning_rate = 0,00065` (i.e. learning_rate = 0.00261 / GPUs). In this case also increase 4x times `burn_in =` in your cfg-file. I.e. use `burn_in = 4000` instead of `1000`.\n\nhttps://groups.google.com/d/msg/darknet/NbJqonJBTSY/Te5PfIpuCAAJ\n\n## How to train (to detect your custom objects):\n(to train old Yolo v2 `yolov2-voc.cfg`, `yolov2-tiny-voc.cfg`, `yolo-voc.cfg`, `yolo-voc.2.0.cfg`, ... [click by the link](https://github.com/AlexeyAB/darknet/tree/47c7af1cea5bbdedf1184963355e6418cb8b1b4f#how-to-train-pascal-voc-data))\n\nTraining Yolo v4 (and v3):\n\n0. For training `cfg/yolov4-custom.cfg` download the pre-trained weights-file (162 MB): [yolov4.conv.137](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137) (Google drive mirror [yolov4.conv.137](https://drive.google.com/open?id=1JKF-bdIklxOOVy-2Cr5qdvjgGpmGfcbp) )\n\n1. Create file `yolo-obj.cfg` with the same content as in `yolov4-custom.cfg` (or copy `yolov4-custom.cfg` to `yolo-obj.cfg)` and:\n\n  * change line batch to [`batch=64`](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L3)\n  * change line subdivisions to [`subdivisions=16`](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L4)\n  * change line max_batches to (`classes*2000` but not less than number of training images, but not less than number of training images and not less than `6000`), f.e. [`max_batches=6000`](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L20) if you train for 3 classes\n  * change line steps to 80% and 90% of max_batches, f.e. [`steps=4800,5400`](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L22)\n  * set network size `width=416 height=416` or any value multiple of 32: https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L8-L9\n  * change line `classes=80` to your number of objects in each of 3 `[yolo]`-layers:\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L610\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L696\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L783\n  * change [`filters=255`] to filters=(classes + 5)x3 in the 3 `[convolutional]` before each `[yolo]` layer, keep in mind that it only has to be the last `[convolutional]` before each of the `[yolo]` layers.\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L603\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L689\n      * https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L776\n  * when using [`[Gaussian_yolo]`](https://github.com/AlexeyAB/darknet/blob/6e5bdf1282ad6b06ed0e962c3f5be67cf63d96dc/cfg/Gaussian_yolov3_BDD.cfg#L608)  layers, change [`filters=57`] filters=(classes + 9)x3 in the 3 `[convolutional]` before each `[Gaussian_yolo]` layer\n      * https://github.com/AlexeyAB/darknet/blob/6e5bdf1282ad6b06ed0e962c3f5be67cf63d96dc/cfg/Gaussian_yolov3_BDD.cfg#L604\n      * https://github.com/AlexeyAB/darknet/blob/6e5bdf1282ad6b06ed0e962c3f5be67cf63d96dc/cfg/Gaussian_yolov3_BDD.cfg#L696\n      * https://github.com/AlexeyAB/darknet/blob/6e5bdf1282ad6b06ed0e962c3f5be67cf63d96dc/cfg/Gaussian_yolov3_BDD.cfg#L789\n      \n  So if `classes=1` then should be `filters=18`. If `classes=2` then write `filters=21`.\n  \n  **(Do not write in the cfg-file: filters=(classes + 5)x3)**\n  \n  (Generally `filters` depends on the `classes`, `coords` and number of `mask`s, i.e. filters=`(classes + coords + 1)*<number of mask>`, where `mask` is indices of anchors. If `mask` is absence, then filters=`(classes + coords + 1)*num`)\n\n  So for example, for 2 objects, your file `yolo-obj.cfg` should differ from `yolov4-custom.cfg` in such lines in each of **3** [yolo]-layers:\n\n  ```\n  [convolutional]\n  filters=21\n\n  [region]\n  classes=2\n  ```\n\n2. Create file `obj.names` in the directory `build\\darknet\\x64\\data\\`, with objects names - each in new line\n\n3. Create file `obj.data` in the directory `build\\darknet\\x64\\data\\`, containing (where **classes = number of objects**):\n\n  ```\n  classes= 2\n  train  = data/train.txt\n  valid  = data/test.txt\n  names = data/obj.names\n  backup = backup/\n  ```\n\n4. Put image-files (.jpg) of your objects in the directory `build\\darknet\\x64\\data\\obj\\`\n\n5. You should label each object on images from your dataset. Use this visual GUI-software for marking bounded boxes of objects and generating annotation files for Yolo v2 & v3: https://github.com/AlexeyAB/Yolo_mark\n\nIt will create `.txt`-file for each `.jpg`-image-file - in the same directory and with the same name, but with `.txt`-extension, and put to file: object number and object coordinates on this image, for each object in new line: \n\n`<object-class> <x_center> <y_center> <width> <height>`\n\n  Where: \n  * `<object-class>` - integer object number from `0` to `(classes-1)`\n  * `<x_center> <y_center> <width> <height>` - float values **relative** to width and height of image, it can be equal from `(0.0 to 1.0]`\n  * for example: `<x> = <absolute_x> / <image_width>` or `<height> = <absolute_height> / <image_height>`\n  * atention: `<x_center> <y_center>` - are center of rectangle (are not top-left corner)\n\n  For example for `img1.jpg` you will be created `img1.txt` containing:\n\n  ```\n  1 0.716797 0.395833 0.216406 0.147222\n  0 0.687109 0.379167 0.255469 0.158333\n  1 0.420312 0.395833 0.140625 0.166667\n  ```\n\n6. Create file `train.txt` in directory `build\\darknet\\x64\\data\\`, with filenames of your images, each filename in new line, with path relative to `darknet.exe`, for example containing:\n\n  ```\n  data/obj/img1.jpg\n  data/obj/img2.jpg\n  data/obj/img3.jpg\n  ```\n\n7. Download pre-trained weights for the convolutional layers and put to the directory `build\\darknet\\x64`\n    * for `yolov4.cfg`, `yolov4-custom.cfg` (162 MB): [yolov4.conv.137](https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137) (Google drive mirror [yolov4.conv.137](https://drive.google.com/open?id=1JKF-bdIklxOOVy-2Cr5qdvjgGpmGfcbp) )\n    * for `csresnext50-panet-spp.cfg` (133 MB): [csresnext50-panet-spp.conv.112](https://drive.google.com/file/d/16yMYCLQTY_oDlCIZPfn_sab6KD3zgzGq/view?usp=sharing)\n    * for `yolov3.cfg, yolov3-spp.cfg` (154 MB): [darknet53.conv.74](https://pjreddie.com/media/files/darknet53.conv.74)\n    * for `yolov3-tiny-prn.cfg , yolov3-tiny.cfg` (6 MB): [yolov3-tiny.conv.11](https://drive.google.com/file/d/18v36esoXCh-PsOKwyP2GWrpYDptDY8Zf/view?usp=sharing)\n    * for `enet-coco.cfg (EfficientNetB0-Yolov3)` (14 MB): [enetb0-coco.conv.132](https://drive.google.com/file/d/1uhh3D6RSn0ekgmsaTcl-ZW53WBaUDo6j/view?usp=sharing)\n    \n\n8. Start training by using the command line: `darknet.exe detector train data/obj.data yolo-obj.cfg yolov4.conv.137`\n     \n   To train on Linux use command: `./darknet detector train data/obj.data yolo-obj.cfg yolov4.conv.137` (just use `./darknet` instead of `darknet.exe`)\n     \n   * (file `yolo-obj_last.weights` will be saved to the `build\\darknet\\x64\\backup\\` for each 100 iterations)\n   * (file `yolo-obj_xxxx.weights` will be saved to the `build\\darknet\\x64\\backup\\` for each 1000 iterations)\n   * (to disable Loss-Window use `darknet.exe detector train data/obj.data yolo-obj.cfg yolov4.conv.137 -dont_show`, if you train on computer without monitor like a cloud Amazon EC2)\n   * (to see the mAP & Loss-chart during training on remote server without GUI, use command `darknet.exe detector train data/obj.data yolo-obj.cfg yolov4.conv.137 -dont_show -mjpeg_port 8090 -map` then open URL `http://ip-address:8090` in Chrome/Firefox browser)\n\n8.1. For training with mAP (mean average precisions) calculation for each 4 Epochs (set `valid=valid.txt` or `train.txt` in `obj.data` file) and run: `darknet.exe detector train data/obj.data yolo-obj.cfg yolov4.conv.137 -map`\n\n9. After training is complete - get result `yolo-obj_final.weights` from path `build\\darknet\\x64\\backup\\`\n\n * After each 100 iterations you can stop and later start training from this point. For example, after 2000 iterations you can stop training, and later just start training using: `darknet.exe detector train data/obj.data yolo-obj.cfg backup\\yolo-obj_2000.weights`\n\n    (in the original repository https://github.com/pjreddie/darknet the weights-file is saved only once every 10 000 iterations `if(iterations > 1000)`)\n\n * Also you can get result earlier than all 45000 iterations.\n \n **Note:** If during training you see `nan` values for `avg` (loss) field - then training goes wrong, but if `nan` is in some other lines - then training goes well.\n \n **Note:** If you changed width= or height= in your cfg-file, then new width and height must be divisible by 32.\n \n **Note:** After training use such command for detection: `darknet.exe detector test data/obj.data yolo-obj.cfg yolo-obj_8000.weights`\n \n  **Note:** if error `Out of memory` occurs then in `.cfg`-file you should increase `subdivisions=16`, 32 or 64: [link](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L4)\n \n### How to train tiny-yolo (to detect your custom objects):\n\nDo all the same steps as for the full yolo model as described above. With the exception of:\n* Download file with the first 29-convolutional layers of yolov4-tiny: https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v4_pre/yolov4-tiny.conv.29\n (Or get this file from yolov4-tiny.weights file by using command: `darknet.exe partial cfg/yolov4-tiny.cfg yolov4-tiny.weights yolov4-tiny.conv.29 29`\n* Make your custom model `yolov4-tiny-obj.cfg` based on `cfg/yolov4-tiny.cfg` instead of `yolov4.cfg`\n* Start training: `darknet.exe detector train data/obj.data yolov4-tiny-obj.cfg yolov4-tiny.conv.29`\n\nFor training Yolo based on other models ([DenseNet201-Yolo](https://github.com/AlexeyAB/darknet/blob/master/build/darknet/x64/densenet201_yolo.cfg) or [ResNet50-Yolo](https://github.com/AlexeyAB/darknet/blob/master/build/darknet/x64/resnet50_yolo.cfg)), you can download and get pre-trained weights as showed in this file: https://github.com/AlexeyAB/darknet/blob/master/build/darknet/x64/partial.cmd\nIf you made you custom model that isn't based on other models, then you can train it without pre-trained weights, then will be used random initial weights.\n \n## When should I stop training:\n\nUsually sufficient 2000 iterations for each class(object), but not less than number of training images and not less than 6000 iterations in total. But for a more precise definition when you should stop training, use the following manual:\n\n1. During training, you will see varying indicators of error, and you should stop when no longer decreases **0.XXXXXXX avg**:\n\n  > Region Avg IOU: 0.798363, Class: 0.893232, Obj: 0.700808, No Obj: 0.004567, Avg Recall: 1.000000,  count: 8\n  > Region Avg IOU: 0.800677, Class: 0.892181, Obj: 0.701590, No Obj: 0.004574, Avg Recall: 1.000000,  count: 8\n  >\n  > **9002**: 0.211667, **0.60730 avg**, 0.001000 rate, 3.868000 seconds, 576128 images\n  > Loaded: 0.000000 seconds\n\n  * **9002** - iteration number (number of batch)\n  * **0.60730 avg** - average loss (error) - **the lower, the better**\n\n  When you see that average loss **0.xxxxxx avg** no longer decreases at many iterations then you should stop training. The final avgerage loss can be from `0.05` (for a small model and easy dataset) to `3.0` (for a big model and a difficult dataset).\n  \n  Or if you train with flag `-map` then you will see mAP indicator `Last accuracy mAP@0.5 = 18.50%` in the console - this indicator is better than Loss, so train while mAP increases. \n\n2. Once training is stopped, you should take some of last `.weights`-files from `darknet\\build\\darknet\\x64\\backup` and choose the best of them:\n\nFor example, you stopped training after 9000 iterations, but the best result can give one of previous weights (7000, 8000, 9000). It can happen due to overfitting. **Overfitting** - is case when you can detect objects on images from training-dataset, but can't detect objects on any others images. You should get weights from **Early Stopping Point**:\n\n![Overfitting](https://hsto.org/files/5dc/7ae/7fa/5dc7ae7fad9d4e3eb3a484c58bfc1ff5.png) \n\nTo get weights from Early Stopping Point:\n\n  2.1. At first, in your file `obj.data` you must specify the path to the validation dataset `valid = valid.txt` (format of `valid.txt` as in `train.txt`), and if you haven't validation images, just copy `data\\train.txt` to `data\\valid.txt`.\n\n  2.2 If training is stopped after 9000 iterations, to validate some of previous weights use this commands:\n\n(If you use another GitHub repository, then use `darknet.exe detector recall`... instead of `darknet.exe detector map`...)\n\n* `darknet.exe detector map data/obj.data yolo-obj.cfg backup\\yolo-obj_7000.weights`\n* `darknet.exe detector map data/obj.data yolo-obj.cfg backup\\yolo-obj_8000.weights`\n* `darknet.exe detector map data/obj.data yolo-obj.cfg backup\\yolo-obj_9000.weights`\n\nAnd comapre last output lines for each weights (7000, 8000, 9000):\n\nChoose weights-file **with the highest mAP (mean average precision)** or IoU (intersect over union)\n\nFor example, **bigger mAP** gives weights `yolo-obj_8000.weights` - then **use this weights for detection**.\n\nOr just train with `-map` flag: \n\n`darknet.exe detector train data/obj.data yolo-obj.cfg yolov4.conv.137 -map` \n\nSo you will see mAP-chart (red-line) in the Loss-chart Window. mAP will be calculated for each 4 Epochs using `valid=valid.txt` file that is specified in `obj.data` file (`1 Epoch = images_in_train_txt / batch` iterations)\n\n(to change the max x-axis value - change [`max_batches=`](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L20) parameter to `2000*classes`, f.e. `max_batches=6000` for 3 classes)\n\n![loss_chart_map_chart](https://hsto.org/webt/yd/vl/ag/ydvlagutof2zcnjodstgroen8ac.jpeg)\n\nExample of custom object detection: `darknet.exe detector test data/obj.data yolo-obj.cfg yolo-obj_8000.weights`\n\n* **IoU** (intersect over union) - average instersect over union of objects and detections for a certain threshold = 0.24\n\n* **mAP** (mean average precision) - mean value of `average precisions` for each class, where `average precision` is average value of 11 points on PR-curve for each possible threshold (each probability of detection) for the same class (Precision-Recall in terms of PascalVOC, where Precision=TP/(TP+FP) and Recall=TP/(TP+FN) ), page-11: http://homepages.inf.ed.ac.uk/ckiw/postscript/ijcv_voc09.pdf\n\n**mAP** is default metric of precision in the PascalVOC competition, **this is the same as AP50** metric in the MS COCO competition.\nIn terms of Wiki, indicators Precision and Recall have a slightly different meaning than in the PascalVOC competition, but **IoU always has the same meaning**.\n\n![precision_recall_iou](https://hsto.org/files/ca8/866/d76/ca8866d76fb840228940dbf442a7f06a.jpg)\n\n\n### Custom object detection:\n\nExample of custom object detection: `darknet.exe detector test data/obj.data yolo-obj.cfg yolo-obj_8000.weights`\n\n| ![Yolo_v2_training](https://hsto.org/files/d12/1e7/515/d121e7515f6a4eb694913f10de5f2b61.jpg) | ![Yolo_v2_training](https://hsto.org/files/727/c7e/5e9/727c7e5e99bf4d4aa34027bb6a5e4bab.jpg) |\n|---|---|\n\n## How to improve object detection:\n\n1. Before training:\n  * set flag `random=1` in your `.cfg`-file - it will increase precision by training Yolo for different resolutions: [link](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L788)\n\n  * increase network resolution in your `.cfg`-file (`height=608`, `width=608` or any value multiple of 32) - it will increase precision\n\n\n  * check that each object that you want to detect is mandatory labeled in your dataset - no one object in your data set should not be without label. In the most training issues - there are wrong labels in your dataset (got labels by using some conversion script, marked with a third-party tool, ...). Always check your dataset by using: https://github.com/AlexeyAB/Yolo_mark\n\n  * my Loss is very high and mAP is very low, is training wrong? Run training with ` -show_imgs` flag at the end of training command, do you see correct bounded boxes of objects (in windows or in files `aug_...jpg`)? If no - your training dataset is wrong.\n\n  * for each object which you want to detect - there must be at least 1 similar object in the Training dataset with about the same: shape, side of object, relative size, angle of rotation, tilt, illumination. So desirable that your training dataset include images with objects at diffrent: scales, rotations, lightings, from different sides, on different backgrounds - you should preferably have 2000 different images for each class or more, and you should train `2000*classes` iterations or more\n\n  * desirable that your training dataset include images with non-labeled objects that you do not want to detect - negative samples without bounded box (empty `.txt` files) - use as many images of negative samples as there are images with objects\n\n  * What is the best way to mark objects: label only the visible part of the object, or label the visible and overlapped part of the object, or label a little more than the entire object (with a little gap)? Mark as you like - how would you like it to be detected.\n\n  * for training with a large number of objects in each image, add the parameter `max=200` or higher value in the last `[yolo]`-layer or `[region]`-layer in your cfg-file (the global maximum number of objects that can be detected by YoloV3 is `0,0615234375*(width*height)` where are width and height are parameters from `[net]` section in cfg-file) \n  \n  * for training for small objects (smaller than 16x16 after the image is resized to 416x416) - set `layers = 23` instead of https://github.com/AlexeyAB/darknet/blob/6f718c257815a984253346bba8fb7aa756c55090/cfg/yolov4.cfg#L895\n      set `stride=4` instead of https://github.com/AlexeyAB/darknet/blob/6f718c257815a984253346bba8fb7aa756c55090/cfg/yolov4.cfg#L892\n      and set `stride=4` instead of https://github.com/AlexeyAB/darknet/blob/6f718c257815a984253346bba8fb7aa756c55090/cfg/yolov4.cfg#L989\n  \n  * for training for both small and large objects use modified models:\n      * Full-model: 5 yolo layers: https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3_5l.cfg\n      * Tiny-model: 3 yolo layers: https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-tiny_3l.cfg\n      * YOLOv4: 3 yolo layers: https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4-custom.cfg\n  \n  * If you train the model to distinguish Left and Right objects as separate classes (left/right hand, left/right-turn on road signs, ...) then for disabling flip data augmentation - add `flip=0` here: https://github.com/AlexeyAB/darknet/blob/3d2d0a7c98dbc8923d9ff705b81ff4f7940ea6ff/cfg/yolov3.cfg#L17\n  \n  * General rule - your training dataset should include such a set of relative sizes of objects that you want to detect: \n\n    * `train_network_width * train_obj_width / train_image_width ~= detection_network_width * detection_obj_width / detection_image_width`\n    * `train_network_height * train_obj_height / train_image_height ~= detection_network_height * detection_obj_height / detection_image_height`\n    \n    I.e. for each object from Test dataset there must be at least 1 object in the Training dataset with the same class_id and about the same relative size:\n\n    `object width in percent from Training dataset` ~= `object width in percent from Test dataset` \n   \n    That is, if only objects that occupied 80-90% of the image were present in the training set, then the trained network will not be able to detect objects that occupy 1-10% of the image.\n    \n  * to speedup training (with decreasing detection accuracy) set param `stopbackward=1` for layer-136 in cfg-file\n\n  * each: `model of object, side, illimination, scale, each 30 grad` of the turn and inclination angles - these are *different objects* from an internal perspective of the neural network. So the more *different objects* you want to detect, the more complex network model should be used.\n\n  * to make the detected bounded boxes more accurate, you can add 3 parameters `ignore_thresh = .9 iou_normalizer=0.5 iou_loss=giou` to each `[yolo]` layer and train, it will increase mAP@0.9, but decrease mAP@0.5.\n\n  * Only if you are an **expert** in neural detection networks - recalculate anchors for your dataset for `width` and `height` from cfg-file:\n  `darknet.exe detector calc_anchors data/obj.data -num_of_clusters 9 -width 416 -height 416`\n   then set the same 9 `anchors` in each of 3 `[yolo]`-layers in your cfg-file. But you should change indexes of anchors `masks=` for each [yolo]-layer, so for YOLOv4 the 1st-[yolo]-layer has anchors smaller than 30x30, 2nd smaller than 60x60, 3rd remaining, and vice versa for YOLOv3. Also you should change the `filters=(classes + 5)*<number of mask>` before each [yolo]-layer. If many of the calculated anchors do not fit under the appropriate layers - then just try using all the default anchors.\n\n\n2. After training - for detection:\n\n  * Increase network-resolution by set in your `.cfg`-file (`height=608` and `width=608`) or (`height=832` and `width=832`) or (any value multiple of 32) - this increases the precision and makes it possible to detect small objects: [link](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L8-L9)\n  \n    * it is not necessary to train the network again, just use `.weights`-file already trained for 416x416 resolution\n    * but to get even greater accuracy you should train with higher resolution 608x608 or 832x832, note: if error `Out of memory` occurs then in `.cfg`-file you should increase `subdivisions=16`, 32 or 64: [link](https://github.com/AlexeyAB/darknet/blob/0039fd26786ab5f71d5af725fc18b3f521e7acfd/cfg/yolov3.cfg#L4)\n\n## How to mark bounded boxes of objects and create annotation files:\n\nHere you can find repository with GUI-software for marking bounded boxes of objects and generating annotation files for Yolo v2 - v4: https://github.com/AlexeyAB/Yolo_mark\n\nWith example of: `train.txt`, `obj.names`, `obj.data`, `yolo-obj.cfg`, `air`1-6`.txt`, `bird`1-4`.txt` for 2 classes of objects (air, bird) and `train_obj.cmd` with example how to train this image-set with Yolo v2 - v4\n\nDifferent tools for marking objects in images:\n1. in C++: https://github.com/AlexeyAB/Yolo_mark \n2. in Python: https://github.com/tzutalin/labelImg\n3. in Python: https://github.com/Cartucho/OpenLabeling\n4. in C++: https://www.ccoderun.ca/darkmark/\n5. in JavaScript: https://github.com/opencv/cvat\n\n\n## How to use Yolo as DLL and SO libraries\n\n* on Linux\n    * using `build.sh` or\n    * build `darknet` using `cmake` or\n    * set `LIBSO=1` in the `Makefile` and do `make`\n* on Windows\n    * using `build.ps1` or\n    * build `darknet` using `cmake` or\n    * compile `build\\darknet\\yolo_cpp_dll.sln` solution or `build\\darknet\\yolo_cpp_dll_no_gpu.sln` solution\n\nThere are 2 APIs:\n* C API: https://github.com/AlexeyAB/darknet/blob/master/include/darknet.h\n    * Python examples using the C API::     \n         * https://github.com/AlexeyAB/darknet/blob/master/darknet.py\t\n         * https://github.com/AlexeyAB/darknet/blob/master/darknet_video.py\n    \n* C++ API: https://github.com/AlexeyAB/darknet/blob/master/include/yolo_v2_class.hpp\n    * C++ example that uses C++ API: https://github.com/AlexeyAB/darknet/blob/master/src/yolo_console_dll.cpp\n    \n----\n\n1. To compile Yolo as C++ DLL-file `yolo_cpp_dll.dll` - open the solution `build\\darknet\\yolo_cpp_dll.sln`, set **x64** and **Release**, and do the: Build -> Build yolo_cpp_dll\n    * You should have installed **CUDA 10.0**\n    * To use cuDNN do: (right click on project) -> properties -> C/C++ -> Preprocessor -> Preprocessor Definitions, and add at the beginning of line: `CUDNN;`\n\n2. To use Yolo as DLL-file in your C++ console application - open the solution `build\\darknet\\yolo_console_dll.sln`, set **x64** and **Release**, and do the: Build -> Build yolo_console_dll\n\n    * you can run your console application from Windows Explorer `build\\darknet\\x64\\yolo_console_dll.exe`\n    **use this command**: `yolo_console_dll.exe data/coco.names yolov4.cfg yolov4.weights test.mp4`\n    \n    * after launching your console application and entering the image file name - you will see info for each object: \n    `<obj_id> <left_x> <top_y> <width> <height> <probability>`\n    * to use simple OpenCV-GUI you should uncomment line `//#define OPENCV` in `yolo_console_dll.cpp`-file: [link](https://github.com/AlexeyAB/darknet/blob/a6cbaeecde40f91ddc3ea09aa26a03ab5bbf8ba8/src/yolo_console_dll.cpp#L5)\n    * you can see source code of simple example for detection on the video file: [link](https://github.com/AlexeyAB/darknet/blob/ab1c5f9e57b4175f29a6ef39e7e68987d3e98704/src/yolo_console_dll.cpp#L75)\n   \n`yolo_cpp_dll.dll`-API: [link](https://github.com/AlexeyAB/darknet/blob/master/src/yolo_v2_class.hpp#L42)\n```\nstruct bbox_t {\n    unsigned int x, y, w, h;    // (x,y) - top-left corner, (w, h) - width & height of bounded box\n    float prob;                    // confidence - probability that the object was found correctly\n    unsigned int obj_id;        // class of object - from range [0, classes-1]\n    unsigned int track_id;        // tracking id for video (0 - untracked, 1 - inf - tracked object)\n    unsigned int frames_counter;// counter of frames on which the object was detected\n};\n\nclass Detector {\npublic:\n        Detector(std::string cfg_filename, std::string weight_filename, int gpu_id = 0);\n        ~Detector();\n\n        std::vector<bbox_t> detect(std::string image_filename, float thresh = 0.2, bool use_mean = false);\n        std::vector<bbox_t> detect(image_t img, float thresh = 0.2, bool use_mean = false);\n        static image_t load_image(std::string image_filename);\n        static void free_image(image_t m);\n\n#ifdef OPENCV\n        std::vector<bbox_t> detect(cv::Mat mat, float thresh = 0.2, bool use_mean = false);\n\tstd::shared_ptr<image_t> mat_to_image_resize(cv::Mat mat) const;\n#endif\n};\n```\n",
            "readme_url": "https://github.com/FarzamIHPC/YoloV3_mask",
            "frameworks": []
        }
    ],
    "references": [
        {
            "title": "CSPNet: A New Backbone that can Enhance Learning Capability of CNN",
            "arxiv": "1911.11929",
            "year": 2019,
            "url": "http://arxiv.org/abs/1911.11929v1",
            "abstract": "Neural networks have enabled state-of-the-art approaches to achieve\nincredible results on computer vision tasks such as object detection. However,\nsuch success greatly relies on costly computation resources, which hinders\npeople with cheap devices from appreciating the advanced technology. In this\npaper, we propose Cross Stage Partial Network (CSPNet) to mitigate the problem\nthat previous works require heavy inference computations from the network\narchitecture perspective. We attribute the problem to the duplicate gradient\ninformation within network optimization. The proposed networks respect the\nvariability of the gradients by integrating feature maps from the beginning and\nthe end of a network stage, which, in our experiments, reduces computations by\n20% with equivalent or even superior accuracy on the ImageNet dataset, and\nsignificantly outperforms state-of-the-art approaches in terms of AP50 on the\nMS COCO object detection dataset. The CSPNet is easy to implement and general\nenough to cope with architectures based on ResNet, ResNeXt, and DenseNet.\nSource code is at https://github.com/WongKinYiu/CrossStagePartialNetworks.",
            "authors": [
                "Chien-Yao Wang",
                "Hong-Yuan Mark Liao",
                "I-Hau Yeh",
                "Yueh-Hua Wu",
                "Ping-Yang Chen",
                "Jun-Wei Hsieh"
            ]
        },
        {
            "title": "YOLOv4: Optimal Speed and Accuracy of Object Detection",
            "arxiv": "2004.10934",
            "year": 2020,
            "url": "http://arxiv.org/abs/2004.10934v1",
            "abstract": "There are a huge number of features which are said to improve Convolutional\nNeural Network (CNN) accuracy. Practical testing of combinations of such\nfeatures on large datasets, and theoretical justification of the result, is\nrequired. Some features operate on certain models exclusively and for certain\nproblems exclusively, or only for small-scale datasets; while some features,\nsuch as batch-normalization and residual-connections, are applicable to the\nmajority of models, tasks, and datasets. We assume that such universal features\ninclude Weighted-Residual-Connections (WRC), Cross-Stage-Partial-connections\n(CSP), Cross mini-Batch Normalization (CmBN), Self-adversarial-training (SAT)\nand Mish-activation. We use new features: WRC, CSP, CmBN, SAT, Mish activation,\nMosaic data augmentation, CmBN, DropBlock regularization, and CIoU loss, and\ncombine some of them to achieve state-of-the-art results: 43.5% AP (65.7% AP50)\nfor the MS COCO dataset at a realtime speed of ~65 FPS on Tesla V100. Source\ncode is at https://github.com/AlexeyAB/darknet",
            "authors": [
                "Alexey Bochkovskiy",
                "Chien-Yao Wang",
                "Hong-Yuan Mark Liao"
            ]
        },
        {
            "title": "YOLOv4 model zoo",
            "url": "https://github.com/AlexeyAB/darknet/wiki/YOLOv4-model-zoo"
        },
        {
            "title": "FAQ - frequently asked questions",
            "url": "https://github.com/AlexeyAB/darknet/wiki/FAQ---frequently-asked-questions"
        },
        {
            "title": "yolov4.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4.cfg"
        },
        {
            "title": "yolov4-tiny.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov4-tiny.cfg"
        },
        {
            "title": "enet-coco.cfg (EfficientNetB0-Yolov3)",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/enet-coco.cfg"
        },
        {
            "title": "yolov3-openimages.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-openimages.cfg"
        },
        {
            "title": "csresnext50-panet-spp-original-optimal.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/csresnext50-panet-spp-original-optimal.cfg"
        },
        {
            "title": "yolov3-spp.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-spp.cfg"
        },
        {
            "title": "csresnext50-panet-spp.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/csresnext50-panet-spp.cfg"
        },
        {
            "title": "yolov3.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3.cfg"
        },
        {
            "title": "yolov3-tiny.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-tiny.cfg"
        },
        {
            "title": "yolov3-tiny-prn.cfg",
            "url": "https://raw.githubusercontent.com/AlexeyAB/darknet/master/cfg/yolov3-tiny-prn.cfg"
        }
    ],
    "training": {
        "datasets": [
            {
                "name": "Amazon"
            },
            {
                "name": "MS-COCO"
            },
            {
                "name": "Wikipedia"
            },
            {
                "name": "COCO"
            },
            {
                "name": "PASCAL VOC 2007"
            },
            {
                "name": "PASCAL VOC 2012"
            },
            {
                "name": "ImageNet"
            }
        ]
    },
    "domain": {
        "domain_type": "Computer Vision",
        "domain_prob": 0.9999999806582268,
        "task": "Object Detection",
        "task_prob": 0.9913785005470864
    }
}