{
    "visibility": {
        "visibility": "public",
        "license": "MIT License"
    },
    "name": "Neural Photo Editor",
    "definition": {
        "code": [
            {
                "type": "repo",
                "repo_type": "github",
                "owner": "ajbrock",
                "owner_type": "User",
                "name": "Neural-Photo-Editor",
                "url": "https://github.com/ajbrock/Neural-Photo-Editor",
                "stars": 2044,
                "pushed_at": "2017-03-22 11:38:44+00:00",
                "created_at": "2016-09-21 14:53:36+00:00",
                "language": "Python",
                "description": "A simple interface for editing natural photos with generative neural networks.",
                "license": "MIT License",
                "frameworks": [
                    "Lasagne",
                    "Theano"
                ]
            },
            {
                "type": "code",
                "name": ".gitattributes",
                "sha": "022809c1c8458dbee5e356772c5ef7fe295090ae",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/.gitattributes"
                    }
                },
                "size": 42
            },
            {
                "type": "code",
                "name": ".gitignore",
                "sha": "31e2cf5de7deae56ca40ce7d53fa921472956eec",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/.gitignore"
                    }
                },
                "size": 20
            },
            {
                "type": "code",
                "name": "API.py",
                "sha": "0f70022c51e6dab89f6fcc8551d58fb5007b1676",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/API.py"
                    }
                },
                "size": 4771
            },
            {
                "type": "code",
                "name": "CelebAValid.npz",
                "sha": "89ac5ba8a8e246f4eff3a12ecb4f617bf239ed2f",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/CelebAValid.npz"
                    }
                },
                "size": 10807586
            },
            {
                "type": "code",
                "name": "GANcheckpoints.py",
                "sha": "9c1a13a5c70335f9aeb2f5279a2559b53dcf2056",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/GANcheckpoints.py"
                    }
                },
                "size": 2133
            },
            {
                "type": "code",
                "name": "IAN.py",
                "sha": "39f908c4a45d6ab65c58b851123b0d4ab42c925a",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/IAN.py"
                    }
                },
                "size": 7648
            },
            {
                "type": "code",
                "name": "IAN_simple.npz",
                "sha": "117c34ab15acf52d9e4cb048092d30bb2dbf8b62",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/IAN_simple.npz"
                    }
                },
                "size": 134
            },
            {
                "type": "code",
                "name": "IAN_simple.py",
                "sha": "52b9c0138c8756ec0c2a57281b5675992ad557c7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/IAN_simple.py"
                    }
                },
                "size": 8175
            },
            {
                "type": "code",
                "name": "IANv1.npz",
                "sha": "c0373b58a579c4ff3474112cc3d7d37271b7c743",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/IANv1.npz"
                    }
                },
                "size": 134
            },
            {
                "type": "code",
                "name": "IANv1.py",
                "sha": "955db9ead0416ffc69cd41d37661b64f9b3905d4",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/IANv1.py"
                    }
                },
                "size": 7349
            },
            {
                "type": "code",
                "name": "LICENSE",
                "sha": "5ac97fb84991b7267a8ce8012c124eac2870c3e5",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/LICENSE"
                    }
                },
                "size": 1067
            },
            {
                "type": "code",
                "name": "NPE.py",
                "sha": "7e41aaead8fedd8cf4eef1d37531b19caa059815",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/NPE.py"
                    }
                },
                "size": 15369
            },
            {
                "type": "code",
                "name": "discgen_utils.py",
                "sha": "f78b4def4734e48c19902b24e0acb3a29766007f",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/discgen_utils.py"
                    }
                },
                "size": 1352
            },
            {
                "type": "code",
                "name": "layers.py",
                "sha": "aaf84a7b63517a4289b40506da9d1e2f188d9820",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/layers.py"
                    }
                },
                "size": 44092
            },
            {
                "type": "code",
                "name": "mask_generator.py",
                "sha": "9038fb59ac7ac5e9247d11cfa28c56f5b35cdd1d",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/mask_generator.py"
                    }
                },
                "size": 5220
            },
            {
                "type": "code",
                "name": "metrics_logging.py",
                "sha": "f983acf6a0cf7ab5930228f04484dfccdedba5c3",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/metrics_logging.py"
                    }
                },
                "size": 1094
            },
            {
                "type": "code",
                "name": "pics",
                "sha": "96233b34ccba706a9f89dca87a9282a3cd836e0a",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/tree/master/pics"
                    }
                },
                "num_files": 1
            },
            {
                "type": "code",
                "name": "sample_IAN.py",
                "sha": "c3bc0fabde7d1b74e6f6012e2314fd9d11d26d61",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/sample_IAN.py"
                    }
                },
                "size": 6433
            },
            {
                "type": "code",
                "name": "train_IAN.py",
                "sha": "e8a8afb0622a207ad8abbc9d4e776af2938e45ca",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/train_IAN.py"
                    }
                },
                "size": 23881
            },
            {
                "type": "code",
                "name": "train_IAN_simple.py",
                "sha": "10caedd45b2018d3af330949e4910c289b0c1db7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/ajbrock/Neural-Photo-Editor/blob/master/train_IAN_simple.py"
                    }
                },
                "size": 46292
            }
        ]
    },
    "authors": [
        {
            "name": "Andy Brock",
            "github_id": "ajbrock"
        },
        {
            "name": "michaelrgb",
            "github_id": "michaelrgb"
        },
        {
            "name": "dribnet",
            "email": "tom@sixdozen.com",
            "github_id": "dribnet"
        }
    ],
    "tags": [
        "machine-learning",
        "deep-learning",
        "gans",
        "computer-vision",
        "interfaces",
        "convolutional-neural-networks"
    ],
    "description": "A simple interface for editing natural photos with generative neural networks.",
    "extraction": [
        {
            "type": "github",
            "url": "https://github.com/ajbrock/Neural-Photo-Editor",
            "stars": 2044,
            "issues": true,
            "readme": "# Neural Photo Editor\nA simple interface for editing natural photos with generative neural networks.\n\n![GUI1](http://i.imgur.com/dmmFOiG.gif) ![GUI2](http://i.imgur.com/mStg8nG.gif) ![GUI3](http://i.imgur.com/CqjTDFN.gif)\n\nThis repository contains code for the paper \"[Neural Photo Editing with Introspective Adversarial Networks](http://arxiv.org/abs/1609.07093),\" and the [Associated Video](https://www.youtube.com/watch?v=FDELBFSeqQs).\n\n## Installation\nTo run the Neural Photo Editor, you will need:\n- Python, likely version 2.7. You may be able to use early versions of Python2, but I'm pretty sure there's some incompatibilities with Python3 in here.\n- [Theano](http://deeplearning.net/software/theano/), development version.  \n- [lasagne](http://lasagne.readthedocs.io/en/latest/user/installation.html), development version.\n- I highly recommend [cuDNN](https://developer.nvidia.com/cudnn) as speed is key, but it is not a dependency.\n- numpy, scipy, PIL, Tkinter and tkColorChooser, but it is likely that your python distribution already has those.\n\n## Running the NPE\nBy default, the NPE runs on IAN_simple. This is a slimmed-down version of the IAN without MDC or RGB-Beta blocks, which runs without lag on a laptop GPU with ~1GB of memory (GT730M)\n\nIf you're on a Windows machine, you will want to create a .theanorc file and at least set the flag FLOATX=float32. \n\nIf you're on a linux machine, you can just insert THEANO_FLAGS=floatX=float32 before the command line call.\n\nIf you don't have cuDNN, simply change line 56 of the NPE.py file from dnn=True to dnn=False. Note that I presently only have the non-cuDNN option working for IAN_simple.\n\nThen, run the command:\n\n```sh\npython NPE.py\n```\nIf you wish to use a different model, simply edit the line with \"config path\" in the NPE.py file. \n\nYou can make use of any model with an inference mechanism (VAE or ALI-based GAN).\n\n## Commands\n- You can paint the image by picking a color and painting on the image, or paint in the latent space canvas (the red and blue tiles below the image). \n- The long horizontal slider controls the magnitude of the latent brush, and the smaller horizontal slider controls the size of both the latent and the main image brush.\n- You can select different entries from the subset of the celebA validation set (included in this repository as an .npz) by typing in a number from 0-999 in the bottom left box and hitting \"infer.\"\n- Use the reset button to return to the ground truth image.\n- Press \"Update\" to update the ground-truth image and corresponding reconstruction with the current image. Use \"Infer\" to return to an original ground truth image from the dataset.\n- Use the sample button to generate a random latent vector and corresponding image.\n- Use the scroll wheel to lighten or darken an image patch (equivalent to using a pure white or pure black paintbrush). Note that this automatically returns you to sample mode, and may require hitting \"infer\" rather than \"reset\" to get back to photo editing.\n\n\n## Training an IAN on celebA\nYou will need [Fuel](https://github.com/mila-udem/fuel) along with the 64x64 version of celebA. See [here](https://github.com/vdumoulin/discgen) for instructions on downloading and preparing it. \n\nIf you wish to train a model, the IAN.py file contains the model configuration, and the train_IAN.py file contains the training code, which can be run like this:\n\n```sh\npython train_IAN.py IAN.py\n```\n\nBy default, this code will save (and overwrite!) the weights to a .npz file with the same name as the config.py file (i.e. \"IAN.py -> IAN.npz\"), and will output a jsonl log of the training with metrics recorded after every chunk.\n\nUse the --resume=True flag when calling to resume training a model--it will automatically pick up from the most recent epoch.\n\n## Sampling the IAN\n#\nYou can generate a sample and reconstruction+interpolation grid with:\n\n```sh\npython sample_IAN.py IAN.py\n```\n\nNote that you will need [matplotlib](http://matplotlib.org/). to do so.\n## Known Issues/Bugs\nMy MADE layer currently only accepts hidden unit sizes that are equal to the size of the latent vector, which will present itself as a BAD_PARAM error.\n\nSince the MADE really only acts as an autoregressive randomizer I'm not too worried about this, but it does bear looking into.\n\nI messed around with the keywords for get_model, you'll need to deal with these if you wish to run any model other than IAN_simple through the editor.\n\nEverything is presently just dumped into a single, unorganized directory. I'll be adding folders and cleaning things up soon.\n\n## Notes\nRemainder of the IAN experiments (including SVHN) coming soon.\n\nI've integrated the plat interface which makes the NPE itself independent of framework, so you should be able to run it with Blocks, TensorFlow, PyTorch, PyCaffe, what have you, by modifying the IAN class provided in models.py.\n\n\n## Acknowledgments\nThis code contains lasagne layers and other goodies adopted from a number of places:\n- MADE wrapped from the implementation by M. Germain et al: https://github.com/mgermain/MADE\n- Gaussian Sample layer from Tencia Lee's Recipe: https://github.com/Lasagne/Recipes/blob/master/examples/variational_autoencoder/variational_autoencoder.py\n- Minibatch Discrimination layer from OpenAI's Improved GAN Techniques: https://github.com/openai/improved-gan\n- Deconv Layer adapted from Radford's DCGAN: https://github.com/Newmu/dcgan_code\n- Image-Grid Plotter adopted from AlexMLamb's Discriminative Regularization: https://github.com/vdumoulin/discgen\n- Metrics_logging and checkpoints adopted from Daniel Maturana's VoxNet: https://github.com/dimatura/voxnet\n- Plat interface adopted from Tom White's plat: https://github.com/dribnet/plat\n",
            "readme_url": "https://github.com/ajbrock/Neural-Photo-Editor",
            "frameworks": [
                "Lasagne",
                "Theano"
            ]
        }
    ],
    "references": [
        {
            "title": "Neural Photo Editing with Introspective Adversarial Networks",
            "arxiv": "1609.07093",
            "year": 2016,
            "url": "http://arxiv.org/abs/1609.07093v3",
            "abstract": "The increasingly photorealistic sample quality of generative image models\nsuggests their feasibility in applications beyond image generation. We present\nthe Neural Photo Editor, an interface that leverages the power of generative\nneural networks to make large, semantically coherent changes to existing\nimages. To tackle the challenge of achieving accurate reconstructions without\nloss of feature quality, we introduce the Introspective Adversarial Network, a\nnovel hybridization of the VAE and GAN. Our model efficiently captures\nlong-range dependencies through use of a computational block based on\nweight-shared dilated convolutions, and improves generalization performance\nwith Orthogonal Regularization, a novel weight regularization method. We\nvalidate our contributions on CelebA, SVHN, and CIFAR-100, and produce samples\nand reconstructions with high visual fidelity.",
            "authors": [
                "Andrew Brock",
                "Theodore Lim",
                "J. M. Ritchie",
                "Nick Weston"
            ]
        }
    ],
    "training": {
        "datasets": [
            {
                "name": "SVHN"
            },
            {
                "name": "CelebA"
            },
            {
                "name": "CIFAR-100"
            }
        ]
    },
    "domain": {
        "domain_type": "Computer Vision",
        "domain_prob": 0.9976835045521459,
        "task": "Image Generation",
        "task_prob": 0.9441334227730709
    }
}