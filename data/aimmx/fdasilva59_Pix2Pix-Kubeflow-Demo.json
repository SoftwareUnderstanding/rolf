{
    "visibility": {
        "visibility": "public",
        "license": "GNU General Public License v3.0"
    },
    "name": "Pix2Pix : Aerial images to maps",
    "definition": {
        "code": [
            {
                "type": "repo",
                "repo_type": "github",
                "owner": "fdasilva59",
                "owner_type": "User",
                "name": "Pix2Pix-Kubeflow-Demo",
                "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo",
                "stars": 4,
                "pushed_at": "2019-07-02 19:15:29+00:00",
                "created_at": "2019-06-19 08:58:05+00:00",
                "language": "Jupyter Notebook",
                "description": "My Pix2Pix implementation used for a Kubeflow Pipelines demo at Google Next 2019",
                "license": "GNU General Public License v3.0",
                "frameworks": [
                    "TensorFlow"
                ]
            },
            {
                "type": "code",
                "name": "1-Pix2Pix-local.ipynb",
                "sha": "9548008bd844a7c9b49d46ead970605cd06ee3f7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/1-Pix2Pix-local.ipynb"
                    }
                },
                "size": 2039965
            },
            {
                "type": "code",
                "name": "2-Pix2Pix-KFP.ipynb",
                "sha": "7603477a35eab330cfda15de7e24f992b4f317ce",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/2-Pix2Pix-KFP.ipynb"
                    }
                },
                "size": 13369
            },
            {
                "type": "code",
                "name": "3-Pix2Pix-KFP-REMOTE.ipynb",
                "sha": "94fba1b45fc6b82e689da0f6c6bc0940af781de8",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/3-Pix2Pix-KFP-REMOTE.ipynb"
                    }
                },
                "size": 16185
            },
            {
                "type": "code",
                "name": "LICENSE",
                "sha": "f288702d2fa16d3cdf0035b15a9fcbc552cd88e7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/LICENSE"
                    }
                },
                "size": 35149
            },
            {
                "type": "code",
                "name": "SETUP.md",
                "sha": "8515c3320d961bd06370d9ca7ad962a0f4b5e3b0",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/SETUP.md"
                    }
                },
                "size": 26308
            },
            {
                "type": "code",
                "name": "doc-assets",
                "sha": "0f7cceb445515dc51e2c7eebeeceef1f917e2e02",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/tree/master/doc-assets"
                    }
                },
                "num_files": 46
            },
            {
                "type": "code",
                "name": "download_dataset.py",
                "sha": "d80f824ea363a72f6edef54eda350431d8c25d4b",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/download_dataset.py"
                    }
                },
                "size": 2189
            },
            {
                "type": "code",
                "name": "prepare_dataset.py",
                "sha": "f5ac4b33dec900ff4a3a8413bbd161403ce03236",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/prepare_dataset.py"
                    }
                },
                "size": 6418
            },
            {
                "type": "code",
                "name": "train_pix2pix.py",
                "sha": "8960f24ff3edcc4c6f4f48b9474fdfa2e494d3e7",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/train_pix2pix.py"
                    }
                },
                "size": 41384
            },
            {
                "type": "code",
                "name": "utils.py",
                "sha": "ffbba81c07539dfb0c832fe4f1a5e52e7dc1d58a",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo/blob/master/utils.py"
                    }
                },
                "size": 8286
            }
        ]
    },
    "authors": [
        {
            "name": "Fabien Da Silva",
            "github_id": "fdasilva59"
        }
    ],
    "tags": [
        "pix2pix",
        "tensorflow",
        "gan",
        "kubeflow",
        "kubeflow-pipelines",
        "google-next",
        "gcp",
        "gke",
        "deeplearning",
        "python"
    ],
    "description": "My Pix2Pix implementation used for a Kubeflow Pipelines demo at Google Next 2019",
    "extraction": [
        {
            "type": "github",
            "url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo",
            "stars": 4,
            "issues": true,
            "readme": "# Pix2Pix : Aerial images to maps\n\nThis repository contains my Pix2Pix implementation that was used for a Kubeflow Pipelines demo at Google Next 2019\n\n\n## Why this project ?\n\nThere were several goals behind this project:\n- Experimenting with image translations using GAN/Pix2Pix and Tensorflow\n- \"Benchmarking\" a GPU datalab server at work\n- Experimenting and developing expertise with the Kubeflow ecosystem (+sharing the results and promoting Kubeflow inside our organization at work)\n\nWhen I first started developping this project, I focused a lot on the early stage of a Data Science project, when a Data Scientist wants  to test new ideas without having to care where the code will be executed, and without any needs to manually build docker containers to package the code. Since then, this is even more easier with Kubeflow Fairing.\n\nThe main reasons why you should use Kubeflow are :\n- It allows easy, repeatable, portable deployments on a diverse infrastructure (laptop <-> ML rig <-> training cluster <-> Production cluster)\n- It makes the work easier and more efficient. Data Scientists can iterate faster\n- In the end, Data Scientists don't have to care about setting up the environment where the code will be executed\n   - \u2019On-prem\u201d clusters resources are not unlimited, and not always available. \n   - Data Scientists don\u2019t want to spend time configuring some architecture to run their experiments.\n   - One of the best features of  using GKE and Kubeflow together, it that you can setup your GKE Cluster with autoscaling. For example, you can add a GPU node-pools to your Kubeflow cluster, that scale on-demand GPU nodes from 0 to whatever value you want.\n   - This type of hybrid configuration makes the work very efficient, and cost-efficient, as you can iterate faster, while paying only for the extra GKE resources you need to expand an \u00ab\u00a0on-prem\u00a0\u00bb cluster/workstation.\n\n\n## Acknowledgments\n\nPix2Pix work based on : \"**Image-to-Image Translation with Conditional Adversarial Networks**\" \n\nSee : [arXiv:1611.07004v3 [cs.CV]](https://arxiv.org/abs/1611.07004) by Phillip Isola, Jun-Yan Zhu, Tinghui Zhou and Alexei A. Efros - [Project Homepage](https://github.com/phillipi/pix2pix) \n\n\nYou might also be interested in more recent works:\n\n- [Pix2Pix Tensorflow 2.0 tutorial](https://www.tensorflow.org/beta/tutorials/generative/pix2pix)\n- [Pix2Pix HD](https://tcwang0509.github.io/pix2pixHD/) \"High-Resolution Image Synthesis and Semantic Manipulation with Conditional GANs\"\n\nThe maps dataset used contain 1096 training images scraped from Google Maps\n\n\n\n## Setup\n\nFollow the [setup instructions](./SETUP.md)\n\n\n### Requirements\n\nThis demo requires a Google Cloud Platform (GCP) project with an IAP-enabled cluster running on Kubernetes Engine (GKE). The Pix2Pix code requires Python 3.5, Tensorflow 1.12 and Kubeflow 0.5.0.\n\n\n### Setup overview\n- Prerequisites : Have a GCP account with billing enabled\n- Create a GCP project (don't forget to adjust the GPU quotas for the considered region)\n- An endpoint protected by GCP IAP will be created for accessing kubeflow. Follow [these instructions](https://www.kubeflow.org/docs/gke/deploy/oauth-setup/) to create an OAuth client and then enter as IAP Oauth Client ID and Secret\n- Create a Kubeflow cluster on GKE, using the [Google Cloud Deploy tool](https://deploy.kubeflow.cloud/#/deploy)\n- Perform additional Setup for REMOTE Kubeflow pipeline execution \n- Create GCP service account with the necessary permissons, and added as an 'IAP-secured Web App User' \n- Create a storage bucket in Google Storage\n- Add an NFS server running in GKE inside the Kubeflow namespace\n- Create a GPU node pool with Autoscaling enabled in GKE\n\n### Known issues \n\nJune/July 2019 : It seems that there are some issues with Kubeflow 0.5 when using IAP. In particular I have noticed some difficulties to access Jupyter Notebooks or spawning a Jupyter server that mounts a NFS volume. Until the issue is solved, a bypass solution is provided in order to avoid using IAP.\n\n### Next steps / Work in progress\n\n- Include the instructions to setup the cluster for REMOTE Kubeflow pipeline execution (instead of external reference)\n- Rework the GKE cluster setup for deployment automation (DevOps for MLOps ! )\n- Investigate Pix2Pix HD\n- Use a cleaner dataset (without traffic information...)\n- Include a Kubeflow Fairing version\n\n\n## How to use\n\nSetup your local environment and your GKE cluster, clone the repository or import the source code, and execute the notebooks ! \n\n**Don't forger to customize in the Notebooks your bucket URL, Kubeflow cluster endpoints and client_id**\n\n\n- `1-Pix2Pix-local.ipynb ` is expected to be executed locally in a Jupyter notebook running on anykind of GPU server (without Kubeflow)\n- `2-Pix2Pix-KFP.ipynb ` is expected to be executed inside the Kubeflow's Jupyter notebook running on a GKE cluster (with some GPU nodes pool available).\n- `3-Pix2Pix-KFP-REMOTE.ipynb ` is expected to be executed in a local Jupyter notebook instance (for instance running on a laptop without GPU), and it will interact with a Kubeflow cluster running on GKE\n\n\n### Some results \n\nResults after ~200 steps (200 epochs with batch size of 1) :\n\nFrom Left to Right : **Source Image / Generated (\"Translated\") Image / Target Image (ground truth)**\n\n![Source Image](doc-assets/img_a-02-174658.png \"Source Image\")\n![Generated Image](doc-assets/fake_b-02-174658.png \"Generated Image\")\n![Target Image (ground truth)](doc-assets/img_b-02-174658.png \"Target Image\")\n\n<br>\n\n\n![Source Image](doc-assets/img_a-02-174852.png \"Source Image\")\n![Generated Image](doc-assets/fake_b-02-174852.png \"Generated Image\")\n![Target Image (ground truth)](doc-assets/img_b-02-174852.png \"Target Image\")\n\n<br>\n\n\n![Source Image](doc-assets/img_a-02-173920.png \"Source Image\")\n![Generated Image](doc-assets/fake_b-02-173920.png \"Generated Image\")\n![Target Image (ground truth)](doc-assets/img_b-02-173920.png \"Target Image\")\n\n\n### Remark on the implementation\n\nIn order to avoid some kind of \"noise artifacts\" to appears in the generated images, and while it was not specified in the Author's paper or original Torch code, I have added some gradient clipping during the optimization steps which solved the problem immediately. \n\nExample of \"Noise artifacts\" that were appearing in the generated images before adding Gradient Clipping :\n\n![Noisy Image](doc-assets/fake_b-13-222626.png \"Noisy Image\")\n\n\n\n## Kubeflow Pipelines at Google Next 2019\n\nSee Google Next 2019 Breakout session : [ML Ops Best Practices on Google Cloud](https://cloud.withgoogle.com/next/sf/speakers?session=MLAI101) (Apr 2019)\n\n> Creating an ML model is just a starting point. To bring it into production, you need to solve various real-world issues, such as building a pipeline for continuous training, automated validation of the model, scalable serving infrastructure, and supporting multiple environments in increasingly common hybrid and multi-cloud setups. In this session, we will learn the concept of \"ML Ops\" (DevOps for ML) and how to leverage various Google initiatives like TFX, Kubeflow Fairing (Hybrid ML SDK) and Kubeflow Pipelines to build and maintain production quality ML systems.\n\nSpeakers :\n\n- Kaz Sato, Developer Advocateat Google Cloud\n- Zia Syed Sr. Engineering Manager at Google Cloud\n- Robin Zondag, Global Head of Atos AI/ML Labs\n- Fabien Da Silva, Artificial Intelligence Expert at Atos/Worldline\n\n\nThanks to the Google Team for all their support during the preparation of Google Next event (Special thanks to Amy Unruh for the great support and tutorials !)\n\n",
            "readme_url": "https://github.com/fdasilva59/Pix2Pix-Kubeflow-Demo",
            "frameworks": [
                "TensorFlow"
            ]
        }
    ],
    "references": [
        {
            "title": "Image-to-Image Translation with Conditional Adversarial Networks",
            "arxiv": "1611.07004",
            "year": 2016,
            "url": "http://arxiv.org/abs/1611.07004v3",
            "abstract": "We investigate conditional adversarial networks as a general-purpose solution\nto image-to-image translation problems. These networks not only learn the\nmapping from input image to output image, but also learn a loss function to\ntrain this mapping. This makes it possible to apply the same generic approach\nto problems that traditionally would require very different loss formulations.\nWe demonstrate that this approach is effective at synthesizing photos from\nlabel maps, reconstructing objects from edge maps, and colorizing images, among\nother tasks. Indeed, since the release of the pix2pix software associated with\nthis paper, a large number of internet users (many of them artists) have posted\ntheir own experiments with our system, further demonstrating its wide\napplicability and ease of adoption without the need for parameter tweaking. As\na community, we no longer hand-engineer our mapping functions, and this work\nsuggests we can achieve reasonable results without hand-engineering our loss\nfunctions either.",
            "authors": [
                "Phillip Isola",
                "Jun-Yan Zhu",
                "Tinghui Zhou",
                "Alexei A. Efros"
            ]
        }
    ],
    "domain": {
        "domain_type": "Computer Vision",
        "domain_prob": 0.8542213596702182,
        "task": "Image-to-Image Translation",
        "task_prob": 0.9227660137817262
    }
}