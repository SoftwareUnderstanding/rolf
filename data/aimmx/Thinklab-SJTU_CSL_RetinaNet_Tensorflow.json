{
    "visibility": {
        "visibility": "public",
        "license": "Apache License 2.0"
    },
    "name": "Arbitrary-Oriented Object Detection with Circular Smooth Label",
    "definition": {
        "code": [
            {
                "type": "repo",
                "repo_type": "github",
                "owner": "Thinklab-SJTU",
                "owner_type": "Organization",
                "name": "CSL_RetinaNet_Tensorflow",
                "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow",
                "stars": 170,
                "pushed_at": "2022-03-21 08:53:42+00:00",
                "created_at": "2020-03-07 08:48:15+00:00",
                "language": "Python",
                "description": "Code for ECCV 2020 paper: Arbitrary-Oriented Object Detection with Circular Smooth Label",
                "license": "Apache License 2.0",
                "frameworks": [
                    "TensorFlow"
                ]
            },
            {
                "type": "code",
                "name": ".DS_Store",
                "sha": "628a03e4a48cab8337934cdfec83f6e4f54fdaeb",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/.DS_Store"
                    }
                },
                "size": 8196
            },
            {
                "type": "code",
                "name": ".gitignore",
                "sha": "6de4faa2b427ce9c4606a6336049ab95372753d8",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/.gitignore"
                    }
                },
                "size": 1418
            },
            {
                "type": "code",
                "name": "CSL.png",
                "sha": "59112b1fd3a455d4ae845554d01ea77adc1fd805",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/CSL.png"
                    }
                },
                "size": 229996
            },
            {
                "type": "code",
                "name": "LICENSE",
                "sha": "261eeb9e9f8b2b4b0d119366dda99c6fd7d35c64",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/LICENSE"
                    }
                },
                "size": 11357
            },
            {
                "type": "code",
                "name": "MODEL_ZOO.md",
                "sha": "cce95da529158bc055a6e23da94ffda8e97a960f",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/MODEL_ZOO.md"
                    }
                },
                "size": 6746
            },
            {
                "type": "code",
                "name": "data",
                "sha": "ccc118519d686128e8576ce526d11309abd5c3de",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/data"
                    }
                },
                "num_files": 3
            },
            {
                "type": "code",
                "name": "demo1.png",
                "sha": "d343bb2e21dc3b073f9b28903ddaeb12c581fbe6",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/demo1.png"
                    }
                },
                "size": 4128779
            },
            {
                "type": "code",
                "name": "eval_devkit",
                "sha": "d7eee3fcfd005d60d5b0f79a33d790dd7c86cf6c",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/eval_devkit"
                    }
                },
                "num_files": 9
            },
            {
                "type": "code",
                "name": "help_utils",
                "sha": "89c300291007d01dcb34f28a804acc3c1c303bbe",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/help_utils"
                    }
                },
                "num_files": 5
            },
            {
                "type": "code",
                "name": "images.png",
                "sha": "c2c3f49415269db4870145203f7eb45b44f522ae",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/images.png"
                    }
                },
                "size": 2970699
            },
            {
                "type": "code",
                "name": "libs",
                "sha": "857c5bfa6c23256ae337545b06cf7ef9ac4fd721",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/libs"
                    }
                },
                "num_files": 10
            },
            {
                "type": "code",
                "name": "ohdet.png",
                "sha": "88420177cf9915021cca9644374a51d206943135",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/ohdet.png"
                    }
                },
                "size": 6505170
            },
            {
                "type": "code",
                "name": "output",
                "sha": "5ade3a4f4b800d18cdb106cff31de7640b83ccfc",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/output"
                    }
                },
                "num_files": 1
            },
            {
                "type": "code",
                "name": "pipeline.png",
                "sha": "5280046979e5021f4f40ff6cbe78b41fa8737710",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/pipeline.png"
                    }
                },
                "size": 1017648
            },
            {
                "type": "code",
                "name": "scalars.png",
                "sha": "fc9181bf8d1026ae87b97a581c5f7a9ad9d6dbad",
                "filetype": "file",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/blob/master/scalars.png"
                    }
                },
                "size": 104717
            },
            {
                "type": "code",
                "name": "tools",
                "sha": "cb121b748bc32a4f435b10eaceda10b8a638388a",
                "filetype": "dir",
                "connection": {
                    "name": "github_url",
                    "source": {
                        "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow/tree/master/tools"
                    }
                },
                "num_files": 11
            }
        ]
    },
    "authors": [
        {
            "name": "yangxue",
            "email": "yangxue-2019-sjtu@sjtu.edu.cn",
            "github_id": "yangxue0827"
        }
    ],
    "tags": [
        "object-detection",
        "tensorflow",
        "smooth-label",
        "angle-classification"
    ],
    "description": "Code for ECCV 2020 paper: Arbitrary-Oriented Object Detection with Circular Smooth Label",
    "extraction": [
        {
            "type": "github",
            "url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow",
            "stars": 170,
            "issues": true,
            "readme": "# Arbitrary-Oriented Object Detection with Circular Smooth Label\n\n[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)\n[![arXiv](http://img.shields.io/badge/cs.CV-arXiv%3A2003.05597-B31B1B.svg)](https://arxiv.org/abs/2003.05597v2)\n\n :rocket::rocket::rocket:\t**News:** CSL is supported at [MMRotate](https://github.com/open-mmlab/mmrotate) <img src=\"https://img.shields.io/github/stars/open-mmlab/mmrotate?style=social\" /> :rocket::rocket::rocket:\n\n## Abstract\nThis repo is based on [Focal Loss for Dense Object Detection](https://arxiv.org/pdf/1708.02002.pdf), and it is completed by [YangXue](https://yangxue0827.github.io/).\n\n**We also recommend a tensorflow-based [rotation detection benchmark](https://github.com/yangxue0827/RotationDetection), which is led by [YangXue](https://yangxue0827.github.io/).**\n\n## Pipeline\n![2](pipeline.png)\n\n## Circular Smooth Label\n![5](CSL.png)\n\n## Latest Performance\n### DOTA1.0 (Task1)\n| Model |    Backbone    |    Training data    |    Val data    |    mAP   | Model Link | Anchor | Label Mode | Reg. Loss| Angle Range | lr schd | Data Augmentation | GPU | Image/GPU | Configs |      \n|:------------:|:------------:|:------------:|:---------:|:-----------:|:----------:|:-----------:|:-----------:|:-----------:|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|    \n| [CSL](https://arxiv.org/abs/2003.05597) | ResNet50_v1d 600->800 | DOTA1.0 trainval | DOTA1.0 test | 67.38 | [Baidu Drive (g3wt)](https://pan.baidu.com/s/1nrIs-oYA53qQzlPjqYkMJQ) | H | **Gaussian (r=1, w=10)** | smooth L1 | **180** | 2x | \u00d7 | 3X GeForce RTX 2080 Ti | 1 | [cfgs_res50_dota_v45.py](./libs/configs/DOTA1.0/CSL/cfgs_res50_dota_v45.py) |\n| [CSL](https://arxiv.org/abs/2003.05597) | ResNet50_v1d 600->800 | DOTA1.0 trainval | DOTA1.0 test | 68.73 | [Baidu Drive (3a4t)](https://pan.baidu.com/s/1yC-b9Y4ZVgVkQvpPRRLmhw) | H | **Pulse (w=1)** | smooth L1 | **180** | 2x | \u00d7 | 2X GeForce RTX 2080 Ti | 1 | [cfgs_res50_dota_v41.py](./libs/configs/DOTA1.0/CSL/cfgs_res50_dota_v41.py) |\n\n**Notice:**     \n**Due to the improvement of the code, the performance of this repo is gradually improving, so the experimental results in other configuration files are for reference only.**        \n**Please refer to [new repo](https://github.com/Thinklab-SJTU/R3Det_Tensorflow) for the latest progress.**\n\n### Visualization\n![1](demo1.png)\n\n## My Development Environment\n**docker images: docker pull yangxue2docker/yx-tf-det:tensorflow1.13.1-cuda10-gpu-py3**      \n1\u3001python3.5 (anaconda recommend)               \n2\u3001cuda 10.0                     \n3\u3001[opencv(cv2)](https://pypi.org/project/opencv-python/)       \n4\u3001[tfplot 0.2.0](https://github.com/wookayin/tensorflow-plot) (optional)            \n5\u3001tensorflow 1.13                      \n\n## Download Model\n### Pretrain weights\n1\u3001Please download [resnet50_v1](http://download.tensorflow.org/models/resnet_v1_50_2016_08_28.tar.gz), [resnet101_v1](http://download.tensorflow.org/models/resnet_v1_101_2016_08_28.tar.gz) pre-trained models on Imagenet, put it to data/pretrained_weights.       \n2\u3001**(Recommend)** Or you can choose to use a better backbone, refer to [gluon2TF](https://github.com/yangJirui/gluon2TF).    \n* [Baidu Drive](https://pan.baidu.com/s/1GpqKg0dOaaWmwshvv1qWGg), password: 5ht9.          \n* [Google Drive](https://drive.google.com/drive/folders/1BM8ffn1WnsRRb5RcuAcyJAHX8NS2M1Gz?usp=sharing)      \n\n## Compile\n```  \ncd $PATH_ROOT/libs/box_utils/cython_utils\npython setup.py build_ext --inplace (or make)\n\ncd $PATH_ROOT/libs/box_utils/\npython setup.py build_ext --inplace\n```\n\n## Train\n\n1\u3001If you want to train your own data, please note:  \n```     \n(1) Modify parameters (such as CLASS_NUM, DATASET_NAME, VERSION, etc.) in $PATH_ROOT/libs/configs/cfgs.py\n(2) Add category information in $PATH_ROOT/libs/label_name_dict/label_dict.py     \n(3) Add data_name to $PATH_ROOT/data/io/read_tfrecord.py \n```     \n\n2\u3001Make tfrecord     \nFor DOTA dataset:      \n```  \ncd $PATH_ROOT\\data\\io\\DOTA\npython data_crop.py\n```  \n\n```  \ncd $PATH_ROOT/data/io/  \npython convert_data_to_tfrecord.py --VOC_dir='/PATH/TO/DOTA/' \n                                   --xml_dir='labeltxt'\n                                   --image_dir='images'\n                                   --save_name='train' \n                                   --img_format='.png' \n                                   --dataset='DOTA'\n```      \n\n3\u3001Multi-gpu train\n```  \ncd $PATH_ROOT/tools\npython multi_gpu_train.py\n```\n\n## Test\n```  \ncd $PATH_ROOT/tools\npython test_dota.py --test_dir='/PATH/TO/IMAGES/'  \n                    --gpus=0,1,2,3,4,5,6,7  \n                    --s (visualization, optional)\n                    --ms (multi-scale test, optional)\n``` \n\n**Notice: In order to set the breakpoint conveniently, the read and write mode of the file is' a+'. If the model of the same #VERSION needs to be tested again, the original test results need to be deleted.**      \n\n## Tensorboard\n```  \ncd $PATH_ROOT/output/summary\ntensorboard --logdir=.\n``` \n\n![3](images.png)\n\n![4](scalars.png)\n\n\n## Object Heading Detection\n- [OHD-SJTU]((https://yangxue0827.github.io/OHD-SJTU.html)): Download from [here](https://yangxue0827.github.io/OHD-SJTU.html).     \n- [OHDet](https://github.com/SJTU-Thinklab-Det/OHDet_Tensorflow): The blue border in the bounding box represents the predicted head of the object. More detail trfer to [here](https://yangxue0827.github.io/CSL_GCL_OHDet.html).          \n\n![6](ohdet.png)\n\n## Citation\n\nIf this is useful for your research, please consider cite.\n\n```\n@article{yang2020arbitrary,\n    title={Arbitrary-Oriented Object Detection with Circular Smooth Label},\n    author={Yang, Xue and Yan, Junchi},\n    journal={European Conference on Computer Vision (ECCV)},\n    year={2020}\n    organization={Springer}\n}\n\n@article{yang2020on,\n    title={On the Arbitrary-Oriented Object Detection: Classification based Approaches Revisited},\n    author={Yang, Xue and Yan, Junchi and He, Tao},\n    year={2020}\n}\n\n@inproceedings{xia2018dota,\n    title={DOTA: A large-scale dataset for object detection in aerial images},\n    author={Xia, Gui-Song and Bai, Xiang and Ding, Jian and Zhu, Zhen and Belongie, Serge and Luo, Jiebo and Datcu, Mihai and Pelillo, Marcello and Zhang, Liangpei},\n    booktitle={Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)},\n    pages={3974--3983},\n    year={2018}\n}\n\n```\n\n\n## Reference\n1\u3001https://github.com/endernewton/tf-faster-rcnn   \n2\u3001https://github.com/zengarden/light_head_rcnn   \n3\u3001https://github.com/tensorflow/models/tree/master/research/object_detection    \n4\u3001https://github.com/fizyr/keras-retinanet     \n",
            "readme_url": "https://github.com/Thinklab-SJTU/CSL_RetinaNet_Tensorflow",
            "frameworks": [
                "TensorFlow"
            ]
        }
    ],
    "references": [
        {
            "title": "On the Arbitrary-Oriented Object Detection: Classification based Approaches Revisited",
            "arxiv": "2003.05597",
            "year": 2020,
            "url": "http://arxiv.org/abs/2003.05597v3",
            "abstract": "Arbitrary-oriented object detection has been a building block for rotation\nsensitive tasks. We first show that the problem of discontinuous boundaries\nsuffered in existing dominant regression-based rotation detectors, is caused by\nangular periodicity or corner ordering, according to the parameterization\nprotocol. We also show that the root cause is that the ideal predictions can be\nout of the defined range. Accordingly, we transform the angular prediction task\nfrom a regression problem to a classification one. For the resulting circularly\ndistributed angle classification problem, we first devise a Circular Smooth\nLabel (CSL) technique to handle the periodicity of angle and increase the error\ntolerance to adjacent angles. To reduce the excessive model parameters by CSL,\nwe further design a Gray Coded Label (GCL), which greatly reduces the length of\nthe encoding. Finally, we further develop an object heading detection module,\nwhich can be useful when the exact heading orientation information is needed\ne.g. for ship and plane heading detection. We release our OHD-SJTU dataset and\nOHDet detector for heading detection. Results on three large-scale public\ndatasets for aerial images i.e. DOTA, HRSC2016, OHD-SJTU, as well as scene text\ndataset ICDAR2015 and MLT, show the effectiveness of our approach.",
            "authors": [
                "Xue Yang",
                "Junchi Yan",
                "Tao He"
            ]
        },
        {
            "title": "Focal Loss for Dense Object Detection",
            "arxiv": "1708.02002",
            "year": 2017,
            "url": "http://arxiv.org/abs/1708.02002v2",
            "abstract": "The highest accuracy object detectors to date are based on a two-stage\napproach popularized by R-CNN, where a classifier is applied to a sparse set of\ncandidate object locations. In contrast, one-stage detectors that are applied\nover a regular, dense sampling of possible object locations have the potential\nto be faster and simpler, but have trailed the accuracy of two-stage detectors\nthus far. In this paper, we investigate why this is the case. We discover that\nthe extreme foreground-background class imbalance encountered during training\nof dense detectors is the central cause. We propose to address this class\nimbalance by reshaping the standard cross entropy loss such that it\ndown-weights the loss assigned to well-classified examples. Our novel Focal\nLoss focuses training on a sparse set of hard examples and prevents the vast\nnumber of easy negatives from overwhelming the detector during training. To\nevaluate the effectiveness of our loss, we design and train a simple dense\ndetector we call RetinaNet. Our results show that when trained with the focal\nloss, RetinaNet is able to match the speed of previous one-stage detectors\nwhile surpassing the accuracy of all existing state-of-the-art two-stage\ndetectors. Code is at: https://github.com/facebookresearch/Detectron.",
            "authors": [
                "Tsung-Yi Lin",
                "Priya Goyal",
                "Ross Girshick",
                "Kaiming He",
                "Piotr Doll\u00e1r"
            ]
        },
        {
            "year": "2020",
            "author": [
                "Yang, Xue",
                "Yan, Junchi",
                "He, Tao"
            ],
            "title": "On the Arbitrary-Oriented Object Detection: Classification based Approaches Revisited",
            "ENTRYTYPE": "article",
            "ID": "yang2020on",
            "authors": [
                "Yang, Xue",
                "Yan, Junchi",
                "He, Tao"
            ]
        },
        {
            "year": "2018",
            "pages": "3974--3983",
            "booktitle": "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)",
            "author": [
                "Xia, Gui-Song",
                "Bai, Xiang",
                "Ding, Jian",
                "Zhu, Zhen",
                "Belongie, Serge",
                "Luo, Jiebo",
                "Datcu, Mihai",
                "Pelillo, Marcello",
                "Zhang, Liangpei"
            ],
            "title": "DOTA: A large-scale dataset for object detection in aerial images",
            "ENTRYTYPE": "inproceedings",
            "ID": "xia2018dota",
            "authors": [
                "Xia, Gui-Song",
                "Bai, Xiang",
                "Ding, Jian",
                "Zhu, Zhen",
                "Belongie, Serge",
                "Luo, Jiebo",
                "Datcu, Mihai",
                "Pelillo, Marcello",
                "Zhang, Liangpei"
            ]
        },
        {
            "title": "Baidu Drive",
            "url": "https://pan.baidu.com/s/1GpqKg0dOaaWmwshvv1qWGg"
        },
        {
            "title": "Google Drive",
            "url": "https://drive.google.com/drive/folders/1BM8ffn1WnsRRb5RcuAcyJAHX8NS2M1Gz?usp=sharing"
        }
    ],
    "training": {
        "datasets": [
            {
                "name": "ImageNet"
            }
        ]
    },
    "domain": {
        "domain_type": "Computer Vision",
        "domain_prob": 0.9999414623129622,
        "task": "Object Detection",
        "task_prob": 0.9741453400162309
    }
}