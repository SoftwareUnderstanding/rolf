{
  "arxivLinks": {
    "confidence": [
      1.0
    ],
    "excerpt": [
      "https://arxiv.org/abs/2002.05202}    \n}\n```\n\n```bibtex\n@inproceedings{kitaev2020reformer,\n    title       = {Reformer: The Efficient Transformer},\n    author      = {Nikita Kitaev and Lukasz Kaiser and Anselm Levskaya},\n    booktitle   = {International Conference on Learning Representations},\n    year        = {2020},\n    url         = {https://openreview.net/forum?id=rkgNKkHtvB}\n}\n```\n\n```bibtex\n@inproceedings{fan2020reducing,\n    title     ={Reducing Transformer Depth on Demand with Structured Dropout},\n    author    ={Angela Fan and Edouard Grave and Armand Joulin},\n    booktitle ={International Conference on Learning Representations},\n    year      ={2020},\n    url       ={https://openreview.net/forum?id=SylO2yStDr}\n}\n```\n\n```bibtex\n@misc{lan2019albert,\n    title       = {ALBERT: A Lite BERT for Self-supervised Learning of Language Representations},\n    author      = {Zhenzhong Lan and Mingda Chen and Sebastian Goodman and Kevin Gimpel and Piyush Sharma and Radu Soricut},\n    year        = {2019},\n    url         = {https://arxiv.org/abs/1909.11942}\n}\n```\n\n```bibtex\n@misc{lample2019large,\n    title   = {Large Memory Layers with Product Keys},\n    author  = {Guillaume Lample and Alexandre Sablayrolles and Marc'Aurelio Ranzato and Ludovic Denoyer and Herv\u00e9 J\u00e9gou},\n    year    = {2019},\n    eprint  = {1907.05242},\n    archivePrefix = {arXiv}\n}\n```\n\n```bibtex\n@article{DBLP:journals/corr/abs-1907-01470,\n    author    = {Sainbayar Sukhbaatar and\n               Edouard Grave and\n               Guillaume Lample and\n               Herv{\\'{e}} J{\\'{e}}gou and\n               Armand Joulin},\n    title     = {Augmenting Self-attention with Persistent Memory},\n    journal   = {CoRR},\n    volume    = {abs/1907.01470},\n    year      = {2019},\n    url       = {http://arxiv.org/abs/1907.01470}\n}\n```\n\n```bibtex\n@misc{bhojanapalli2020lowrank,\n    title   = {Low-Rank Bottleneck in Multi-head Attention Models},\n    author  = {Srinadh Bhojanapalli and Chulhee Yun and Ankit Singh Rawat and Sashank J. Reddi and Sanjiv Kumar},\n    year    = {2020},\n    eprint  = {2002.07028}\n}\n```\n\n```bibtex\n@article{1910.05895,\n    author  = {Toan Q. Nguyen and Julian Salazar},\n    title   = {Transformers without Tears: Improving the Normalization of Self-Attention},\n    year    = {2019},\n    eprint  = {arXiv:1910.05895},\n    doi     = {10.5281/zenodo.3525484},\n}\n```\n\n```bibtex\n@misc{bachlechner2020rezero,\n    title   = {ReZero is All You Need: Fast Convergence at Large Depth},\n    author  = {Thomas Bachlechner and Bodhisattwa Prasad Majumder and Huanru Henry Mao and Garrison W. Cottrell and Julian McAuley},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2003.04887}\n}\n```\n\n```bibtex\n@misc{vaswani2017attention,\n    title   = {Attention Is All You Need},\n    author  = {Ashish Vaswani and Noam Shazeer and Niki Parmar and Jakob Uszkoreit and Llion Jones and Aidan N. Gomez and Lukasz Kaiser and Illia Polosukhin},\n    year    = {2017},\n    eprint  = {1706.03762},\n    archivePrefix = {arXiv},\n    primaryClass = {cs.CL}\n}\n```\n\n```bibtex\n@software{peng_bo_2021_5196578,\n    author       = {PENG Bo},\n    title        = {BlinkDL/RWKV-LM: 0.01},\n    month        = {aug},\n    year         = {2021},\n    publisher    = {Zenodo},\n    version      = {0.01},\n    doi          = {10.5281/zenodo.5196578},\n    url          = {https://doi.org/10.5281/zenodo.5196578}\n}\n```",
      "https://arxiv.org/abs/1909.11942}\n}\n```\n\n```bibtex\n@misc{lample2019large,\n    title   = {Large Memory Layers with Product Keys},\n    author  = {Guillaume Lample and Alexandre Sablayrolles and Marc'Aurelio Ranzato and Ludovic Denoyer and Herv\u00e9 J\u00e9gou},\n    year    = {2019},\n    eprint  = {1907.05242},\n    archivePrefix = {arXiv}\n}\n```\n\n```bibtex\n@article{DBLP:journals/corr/abs-1907-01470,\n    author    = {Sainbayar Sukhbaatar and\n               Edouard Grave and\n               Guillaume Lample and\n               Herv{\\'{e}} J{\\'{e}}gou and\n               Armand Joulin},\n    title     = {Augmenting Self-attention with Persistent Memory},\n    journal   = {CoRR},\n    volume    = {abs/1907.01470},\n    year      = {2019},\n    url       = {http://arxiv.org/abs/1907.01470}\n}\n```\n\n```bibtex\n@misc{bhojanapalli2020lowrank,\n    title   = {Low-Rank Bottleneck in Multi-head Attention Models},\n    author  = {Srinadh Bhojanapalli and Chulhee Yun and Ankit Singh Rawat and Sashank J. Reddi and Sanjiv Kumar},\n    year    = {2020},\n    eprint  = {2002.07028}\n}\n```\n\n```bibtex\n@article{1910.05895,\n    author  = {Toan Q. Nguyen and Julian Salazar},\n    title   = {Transformers without Tears: Improving the Normalization of Self-Attention},\n    year    = {2019},\n    eprint  = {arXiv:1910.05895},\n    doi     = {10.5281/zenodo.3525484},\n}\n```\n\n```bibtex\n@misc{bachlechner2020rezero,\n    title   = {ReZero is All You Need: Fast Convergence at Large Depth},\n    author  = {Thomas Bachlechner and Bodhisattwa Prasad Majumder and Huanru Henry Mao and Garrison W. Cottrell and Julian McAuley},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2003.04887}\n}\n```\n\n```bibtex\n@misc{vaswani2017attention,\n    title   = {Attention Is All You Need},\n    author  = {Ashish Vaswani and Noam Shazeer and Niki Parmar and Jakob Uszkoreit and Llion Jones and Aidan N. Gomez and Lukasz Kaiser and Illia Polosukhin},\n    year    = {2017},\n    eprint  = {1706.03762},\n    archivePrefix = {arXiv},\n    primaryClass = {cs.CL}\n}\n```\n\n```bibtex\n@software{peng_bo_2021_5196578,\n    author       = {PENG Bo},\n    title        = {BlinkDL/RWKV-LM: 0.01},\n    month        = {aug},\n    year         = {2021},\n    publisher    = {Zenodo},\n    version      = {0.01},\n    doi          = {10.5281/zenodo.5196578},\n    url          = {https://doi.org/10.5281/zenodo.5196578}\n}\n```",
      "https://arxiv.org/abs/2003.04887}\n}\n```\n\n```bibtex\n@misc{vaswani2017attention,\n    title   = {Attention Is All You Need},\n    author  = {Ashish Vaswani and Noam Shazeer and Niki Parmar and Jakob Uszkoreit and Llion Jones and Aidan N. Gomez and Lukasz Kaiser and Illia Polosukhin},\n    year    = {2017},\n    eprint  = {1706.03762},\n    archivePrefix = {arXiv},\n    primaryClass = {cs.CL}\n}\n```\n\n```bibtex\n@software{peng_bo_2021_5196578,\n    author       = {PENG Bo},\n    title        = {BlinkDL/RWKV-LM: 0.01},\n    month        = {aug},\n    year         = {2021},\n    publisher    = {Zenodo},\n    version      = {0.01},\n    doi          = {10.5281/zenodo.5196578},\n    url          = {https://doi.org/10.5281/zenodo.5196578}\n}\n```",
      "https://arxiv.org/abs/1910.05895"
    ],
    "technique": "Regular expression"
  },
  "citation": [
    {
      "confidence": [
        1
      ],
      "excerpt": "```bibtex\n@misc{roy*2020efficient,\n    title   = {Efficient Content-Based Sparse Attention with Routing Transformers},\n    author  = {Aurko Roy* and Mohammad Taghi Saffar* and David Grangier and Ashish Vaswani},\n    year    = {2020},\n    url     = {https://arxiv.org/pdf/2003.05997.pdf}\n}\n```\n\n```bibtex\n@misc{shazeer2020glu,\n    title   = {GLU Variants Improve Transformer},\n    author  = {Noam Shazeer},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2002.05202}    \n}\n```\n\n```bibtex\n@inproceedings{kitaev2020reformer,\n    title       = {Reformer: The Efficient Transformer},\n    author      = {Nikita Kitaev and Lukasz Kaiser and Anselm Levskaya},\n    booktitle   = {International Conference on Learning Representations},\n    year        = {2020},\n    url         = {https://openreview.net/forum?id=rkgNKkHtvB}\n}\n```\n\n```bibtex\n@inproceedings{fan2020reducing,\n    title     ={Reducing Transformer Depth on Demand with Structured Dropout},\n    author    ={Angela Fan and Edouard Grave and Armand Joulin},\n    booktitle ={International Conference on Learning Representations},\n    year      ={2020},\n    url       ={https://openreview.net/forum?id=SylO2yStDr}\n}\n```\n\n```bibtex\n@misc{lan2019albert,\n    title       = {ALBERT: A Lite BERT for Self-supervised Learning of Language Representations},\n    author      = {Zhenzhong Lan and Mingda Chen and Sebastian Goodman and Kevin Gimpel and Piyush Sharma and Radu Soricut},\n    year        = {2019},\n    url         = {https://arxiv.org/abs/1909.11942}\n}\n```\n\n```bibtex\n@misc{lample2019large,\n    title   = {Large Memory Layers with Product Keys},\n    author  = {Guillaume Lample and Alexandre Sablayrolles and Marc'Aurelio Ranzato and Ludovic Denoyer and Herv\u00e9 J\u00e9gou},\n    year    = {2019},\n    eprint  = {1907.05242},\n    archivePrefix = {arXiv}\n}\n```\n\n```bibtex\n@article{DBLP:journals/corr/abs-1907-01470,\n    author    = {Sainbayar Sukhbaatar and\n               Edouard Grave and\n               Guillaume Lample and\n               Herv{\\'{e}} J{\\'{e}}gou and\n               Armand Joulin},\n    title     = {Augmenting Self-attention with Persistent Memory},\n    journal   = {CoRR},\n    volume    = {abs/1907.01470},\n    year      = {2019},\n    url       = {http://arxiv.org/abs/1907.01470}\n}\n```\n\n```bibtex\n@misc{bhojanapalli2020lowrank,\n    title   = {Low-Rank Bottleneck in Multi-head Attention Models},\n    author  = {Srinadh Bhojanapalli and Chulhee Yun and Ankit Singh Rawat and Sashank J. Reddi and Sanjiv Kumar},\n    year    = {2020},\n    eprint  = {2002.07028}\n}\n```\n\n```bibtex\n@article{1910.05895,\n    author  = {Toan Q. Nguyen and Julian Salazar},\n    title   = {Transformers without Tears: Improving the Normalization of Self-Attention},\n    year    = {2019},\n    eprint  = {arXiv:1910.05895},\n    doi     = {10.5281/zenodo.3525484},\n}\n```\n\n```bibtex\n@misc{bachlechner2020rezero,\n    title   = {ReZero is All You Need: Fast Convergence at Large Depth},\n    author  = {Thomas Bachlechner and Bodhisattwa Prasad Majumder and Huanru Henry Mao and Garrison W. Cottrell and Julian McAuley},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2003.04887}\n}\n```\n\n```bibtex\n@misc{vaswani2017attention,\n    title   = {Attention Is All You Need},\n    author  = {Ashish Vaswani and Noam Shazeer and Niki Parmar and Jakob Uszkoreit and Llion Jones and Aidan N. Gomez and Lukasz Kaiser and Illia Polosukhin},\n    year    = {2017},\n    eprint  = {1706.03762},\n    archivePrefix = {arXiv},\n    primaryClass = {cs.CL}\n}\n```\n\n```bibtex\n@software{peng_bo_2021_5196578,\n    author       = {PENG Bo},\n    title        = {BlinkDL/RWKV-LM: 0.01},\n    month        = {aug},\n    year         = {2021},\n    publisher    = {Zenodo},\n    version      = {0.01},\n    doi          = {10.5281/zenodo.5196578},\n    url          = {https://doi.org/10.5281/zenodo.5196578}\n}\n```\n",
      "technique": "Header extraction"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@software{peng_bo_2021_5196578,\n    author       = {PENG Bo},\n    title        = {BlinkDL/RWKV-LM: 0.01},\n    month        = {aug},\n    year         = {2021},\n    publisher    = {Zenodo},\n    version      = {0.01},\n    doi          = {10.5281/zenodo.5196578},\n    url          = {https://doi.org/10.5281/zenodo.5196578}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{vaswani2017attention,\n    title   = {Attention Is All You Need},\n    author  = {Ashish Vaswani and Noam Shazeer and Niki Parmar and Jakob Uszkoreit and Llion Jones and Aidan N. Gomez and Lukasz Kaiser and Illia Polosukhin},\n    year    = {2017},\n    eprint  = {1706.03762},\n    archivePrefix = {arXiv},\n    primaryClass = {cs.CL}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{bachlechner2020rezero,\n    title   = {ReZero is All You Need: Fast Convergence at Large Depth},\n    author  = {Thomas Bachlechner and Bodhisattwa Prasad Majumder and Huanru Henry Mao and Garrison W. Cottrell and Julian McAuley},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2003.04887}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@article{1910.05895,\n    author  = {Toan Q. Nguyen and Julian Salazar},\n    title   = {Transformers without Tears: Improving the Normalization of Self-Attention},\n    year    = {2019},\n    eprint  = {arXiv:1910.05895},\n    doi     = {10.5281/zenodo.3525484},\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{bhojanapalli2020lowrank,\n    title   = {Low-Rank Bottleneck in Multi-head Attention Models},\n    author  = {Srinadh Bhojanapalli and Chulhee Yun and Ankit Singh Rawat and Sashank J. Reddi and Sanjiv Kumar},\n    year    = {2020},\n    eprint  = {2002.07028}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@article{DBLP:journals/corr/abs-1907-01470,\n    author    = {Sainbayar Sukhbaatar and\n               Edouard Grave and\n               Guillaume Lample and\n               Herv{\\'{e}} J{\\'{e}}gou and\n               Armand Joulin},\n    title     = {Augmenting Self-attention with Persistent Memory},\n    journal   = {CoRR},\n    volume    = {abs/1907.01470},\n    year      = {2019},\n    url       = {http://arxiv.org/abs/1907.01470}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{lample2019large,\n    title   = {Large Memory Layers with Product Keys},\n    author  = {Guillaume Lample and Alexandre Sablayrolles and Marc'Aurelio Ranzato and Ludovic Denoyer and Herv\u00e9 J\u00e9gou},\n    year    = {2019},\n    eprint  = {1907.05242},\n    archivePrefix = {arXiv}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{lan2019albert,\n    title       = {ALBERT: A Lite BERT for Self-supervised Learning of Language Representations},\n    author      = {Zhenzhong Lan and Mingda Chen and Sebastian Goodman and Kevin Gimpel and Piyush Sharma and Radu Soricut},\n    year        = {2019},\n    url         = {https://arxiv.org/abs/1909.11942}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@inproceedings{fan2020reducing,\n    title     ={Reducing Transformer Depth on Demand with Structured Dropout},\n    author    ={Angela Fan and Edouard Grave and Armand Joulin},\n    booktitle ={International Conference on Learning Representations},\n    year      ={2020},\n    url       ={https://openreview.net/forum?id=SylO2yStDr}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@inproceedings{kitaev2020reformer,\n    title       = {Reformer: The Efficient Transformer},\n    author      = {Nikita Kitaev and Lukasz Kaiser and Anselm Levskaya},\n    booktitle   = {International Conference on Learning Representations},\n    year        = {2020},\n    url         = {https://openreview.net/forum?id=rkgNKkHtvB}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{shazeer2020glu,\n    title   = {GLU Variants Improve Transformer},\n    author  = {Noam Shazeer},\n    year    = {2020},\n    url     = {https://arxiv.org/abs/2002.05202}    \n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "@misc{roy*2020efficient,\n    title   = {Efficient Content-Based Sparse Attention with Routing Transformers},\n    author  = {Aurko Roy* and Mohammad Taghi Saffar* and David Grangier and Ashish Vaswani},\n    year    = {2020},\n    url     = {https://arxiv.org/pdf/2003.05997.pdf}\n}",
      "technique": "Regular expression"
    },
    {
      "confidence": [
        0.8356013927728488
      ],
      "excerpt": "    depth = 12, \n",
      "technique": "Supervised classification"
    }
  ],
  "codeRepository": {
    "confidence": [
      1.0
    ],
    "excerpt": "https://github.com/lucidrains/routing-transformer",
    "technique": "GitHub API"
  },
  "dateCreated": {
    "confidence": [
      1.0
    ],
    "excerpt": "2020-05-22T18:54:10Z",
    "technique": "GitHub API"
  },
  "dateModified": {
    "confidence": [
      1.0
    ],
    "excerpt": "2021-12-23T14:45:17Z",
    "technique": "GitHub API"
  },
  "description": [
    {
      "confidence": [
        0.8806483551894143
      ],
      "excerpt": "A fully featured implementation of <a href=\"https://arxiv.org/pdf/2003.05997.pdf\">Routing Transformer</a>. The paper proposes using k-means to route similar queries / keys into the same cluster for attention. \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.860059181823877
      ],
      "excerpt": "model = RoutingTransformerEncDec( \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9838541693009993
      ],
      "excerpt": "To see the benefits of using PKM, the learning rate of the values must be set higher than the rest of the parameters. (Recommended to be 1e-2) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9693233393948762,
        0.9684376309992898,
        0.9693233393948762,
        0.9730882742340643,
        0.8535595135461022
      ],
      "excerpt": "kmeans_ema_decay = {defaults to 0.999} \nThis is the exponential moving average decay for updating the k-means. The lower this is, the faster the means will adjust, but at the cost of stability. \ncommitment_factor = {defaults to 1e-4} \nThe weight of the auxiliary loss that encourages tokens to get closer (commit) to the k-mean centroids that were chosen for them. \nThe following instructions will allow you to update the kmeans manually. By default the kmeans are updated automatically on every backward pass. \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.860059181823877
      ],
      "excerpt": "model = RoutingTransformerLM( \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8774119041572569
      ],
      "excerpt": "    _register_kmeans_update = False #: set to False to disable auto-updating \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.860059181823877
      ],
      "excerpt": "model = AutoregressiveWrapper(model) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9405442859699694
      ],
      "excerpt": "This architecture has trouble generalizing to shorter sequence lengths when decoding tokens from 1 -> maximum sequence length. The simplest and surest solution is to randomly truncate the sequence during training. This helps the network and the kmeans generalize to variable number of tokens, at the cost of prolonged training. \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.860059181823877
      ],
      "excerpt": "model = RoutingTransformerLM( \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.860059181823877
      ],
      "excerpt": "model = AutoregressiveWrapper(model) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        1.0
      ],
      "excerpt": "Fully featured implementation of Routing Transformer",
      "technique": "GitHub API"
    }
  ],
  "downloadUrl": {
    "confidence": [
      1.0
    ],
    "excerpt": "https://github.com/lucidrains/routing-transformer/releases",
    "technique": "GitHub API"
  },
  "forks_count": {
    "confidence": [
      1.0
    ],
    "excerpt": {
      "count": 25,
      "date": "Tue, 28 Dec 2021 19:03:11 GMT"
    },
    "technique": "GitHub API"
  },
  "forks_url": {
    "confidence": [
      1.0
    ],
    "excerpt": "https://api.github.com/repos/lucidrains/routing-transformer/forks",
    "technique": "GitHub API"
  },
  "fullName": {
    "confidence": [
      1.0
    ],
    "excerpt": "lucidrains/routing-transformer",
    "technique": "GitHub API"
  },
  "installation": [
    {
      "confidence": [
        1
      ],
      "excerpt": "```bash\n$ pip install routing_transformer\n```\n\n",
      "technique": "Header extraction"
    },
    {
      "confidence": [
        0.9179688463369292
      ],
      "excerpt": "You can follow the instructions here to set it correctly https://github.com/lucidrains/product-key-memory#learning-rates \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9313266022797401
      ],
      "excerpt": "The following instructions will allow you to update the kmeans manually. By default the kmeans are updated automatically on every backward pass. \n",
      "technique": "Supervised classification"
    }
  ],
  "invocation": [
    {
      "confidence": [
        0.8481942365069672
      ],
      "excerpt": "<img src=\"./routing_attention.png\" width=\"500px\"></img> \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8801854956928516
      ],
      "excerpt": "from routing_transformer import RoutingTransformerEncDec \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8594142235991984
      ],
      "excerpt": "    dec_reversible = True \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9189557160413634
      ],
      "excerpt": "loss, aux_loss = model(src, tgt, enc_input_mask = src_mask, dec_input_mask = tgt_mask, return_loss = True, randomly_truncate_sequence = True) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.9357765002628391
      ],
      "excerpt": "sample = model.generate(src, start_tokens, seq_len = 2048, eos_token = 2) #: (1, <= 2048, 20000) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8801854956928516
      ],
      "excerpt": "from routing_transformer import RoutingTransformerLM, AutoregressiveWrapper \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8639258741734444
      ],
      "excerpt": "    depth = 6, \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8594142235991984,
        0.8205107056074382
      ],
      "excerpt": "    causal = True, \n    _register_kmeans_update = False #: set to False to disable auto-updating \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8190200549205122
      ],
      "excerpt": "loss = model(x, return_loss = True) \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8801854956928516
      ],
      "excerpt": "from routing_transformer import RoutingTransformerLM, AutoregressiveWrapper \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.8594142235991984
      ],
      "excerpt": "    causal = True \n",
      "technique": "Supervised classification"
    },
    {
      "confidence": [
        0.855048412389544
      ],
      "excerpt": "loss = model(x, return_loss = True, randomly_truncate_sequence = True) #: (1, 8192, 20000) \n",
      "technique": "Supervised classification"
    }
  ],
  "issueTracker": {
    "confidence": [
      1.0
    ],
    "excerpt": "https://api.github.com/repos/lucidrains/routing-transformer/issues{/number}",
    "technique": "GitHub API"
  },
  "languages": {
    "confidence": [
      1.0
    ],
    "excerpt": [
      "Python"
    ],
    "technique": "GitHub API"
  },
  "license": {
    "confidence": [
      1.0
    ],
    "excerpt": {
      "name": "MIT License",
      "url": "https://api.github.com/licenses/mit"
    },
    "technique": "GitHub API"
  },
  "licenseText": {
    "confidence": [
      1.0
    ],
    "excerpt": "b'MIT License\\n\\nCopyright (c) 2020 Phil Wang\\n\\nPermission is hereby granted, free of charge, to any person obtaining a copy\\nof this software and associated documentation files (the \"Software\"), to deal\\nin the Software without restriction, including without limitation the rights\\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\ncopies of the Software, and to permit persons to whom the Software is\\nfurnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all\\ncopies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\\nSOFTWARE.\\n'",
    "technique": "File Exploration"
  },
  "long_title": {
    "confidence": [
      1.0
    ],
    "excerpt": "# Routing Transformer",
    "technique": "Regular expression"
  },
  "name": {
    "confidence": [
      1.0
    ],
    "excerpt": "routing-transformer",
    "technique": "GitHub API"
  },
  "owner": {
    "confidence": [
      1.0
    ],
    "excerpt": "lucidrains",
    "technique": "GitHub API"
  },
  "ownerType": {
    "confidence": [
      1.0
    ],
    "excerpt": "User",
    "technique": "GitHub API"
  },
  "readme_url": {
    "confidence": [
      1.0
    ],
    "excerpt": "https://github.com/lucidrains/routing-transformer/blob/master/README.md",
    "technique": "GitHub API"
  },
  "releases": {
    "confidence": [
      1.0
    ],
    "excerpt": [
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-11-06T23:11:24Z",
        "datePublished": "2021-11-06T23:11:38Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.6.1",
        "name": "1.6.1",
        "tag_name": "1.6.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.6.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/52855959",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.6.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-08-16T16:44:32Z",
        "datePublished": "2021-08-16T16:45:01Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.6.0",
        "name": "1.6.0",
        "tag_name": "1.6.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.6.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/47922609",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.6.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-05-20T16:36:23Z",
        "datePublished": "2021-05-20T16:36:36Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.5.2",
        "name": "1.5.2",
        "tag_name": "1.5.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.5.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/43300513",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.5.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-04-14T23:17:27Z",
        "datePublished": "2021-04-14T23:18:05Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.5.1",
        "name": "1.5.1",
        "tag_name": "1.5.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.5.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/41447896",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.5.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-04-14T20:02:30Z",
        "datePublished": "2021-04-14T20:02:43Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.5.0",
        "name": "1.5.0",
        "tag_name": "1.5.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.5.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/41439461",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.5.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2021-02-04T22:41:27Z",
        "datePublished": "2021-02-04T22:42:34Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.4.3",
        "name": "1.4.3",
        "tag_name": "1.4.3",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.4.3",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/37381245",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.4.3"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-12-11T17:37:39Z",
        "datePublished": "2020-12-11T17:37:55Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.4.2",
        "name": "1.4.2",
        "tag_name": "1.4.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.4.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/35165566",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.4.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-11-12T16:35:13Z",
        "datePublished": "2020-11-12T16:35:28Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.4.1",
        "name": "1.4.1",
        "tag_name": "1.4.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.4.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33866518",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.4.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-11-04T20:14:15Z",
        "datePublished": "2020-11-04T20:14:30Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.4.0",
        "name": "1.4.0",
        "tag_name": "1.4.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.4.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33471874",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.4.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-11-01T02:28:06Z",
        "datePublished": "2020-11-01T02:28:26Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.3.0",
        "name": "1.3.0",
        "tag_name": "1.3.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.3.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33313744",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.3.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-30T02:42:36Z",
        "datePublished": "2020-10-30T02:42:49Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.2.2",
        "name": "1.2.2",
        "tag_name": "1.2.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.2.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33250513",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.2.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-29T20:15:47Z",
        "datePublished": "2020-10-29T20:16:17Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.2.1",
        "name": "1.2.1",
        "tag_name": "1.2.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.2.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33239960",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.2.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-29T16:54:58Z",
        "datePublished": "2020-10-29T16:55:14Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.2.0",
        "name": "1.2.0",
        "tag_name": "1.2.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.2.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33230903",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.2.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-28T16:56:39Z",
        "datePublished": "2020-10-28T16:56:55Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.1.4",
        "name": "1.1.4",
        "tag_name": "1.1.4",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.1.4",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33176618",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.1.4"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-28T16:20:12Z",
        "datePublished": "2020-10-28T16:20:27Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.1.3",
        "name": "1.1.3",
        "tag_name": "1.1.3",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.1.3",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/33174232",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.1.3"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-21T11:06:13Z",
        "datePublished": "2020-10-21T11:06:28Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.1.2",
        "name": "1.1.2",
        "tag_name": "1.1.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.1.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/32858730",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.1.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-21T03:39:48Z",
        "datePublished": "2020-10-21T03:40:03Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.1.1",
        "name": "1.1.1",
        "tag_name": "1.1.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.1.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/32844255",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.1.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-21T03:31:51Z",
        "datePublished": "2020-10-21T03:32:09Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.1.0",
        "name": "1.1.0",
        "tag_name": "1.1.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.1.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/32844110",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.1.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-10-20T22:21:27Z",
        "datePublished": "2020-10-20T22:21:40Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.0.2",
        "name": "1.0.2",
        "tag_name": "1.0.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.0.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/32836813",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.0.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-08-05T19:58:22Z",
        "datePublished": "2020-08-05T19:58:36Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.0.1",
        "name": "1.0.1",
        "tag_name": "1.0.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.0.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/29380536",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.0.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-08-04T20:01:38Z",
        "datePublished": "2020-08-04T20:01:59Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/1.0.0",
        "name": "1.0.0",
        "tag_name": "1.0.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/1.0.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/29288267",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/1.0.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-21T05:37:59Z",
        "datePublished": "2020-07-21T05:38:38Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.11.4",
        "name": "0.11.4",
        "tag_name": "0.11.4",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.11.4",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28767061",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.11.4"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-21T05:15:37Z",
        "datePublished": "2020-07-21T05:15:56Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.11.2",
        "name": "0.11.2",
        "tag_name": "0.11.2",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.11.2",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28766538",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.11.2"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-21T04:31:15Z",
        "datePublished": "2020-07-21T04:31:40Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.11.1",
        "name": "0.11.1",
        "tag_name": "0.11.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.11.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28765781",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.11.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-19T03:26:39Z",
        "datePublished": "2020-07-19T03:26:57Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.11.0",
        "name": "0.11.0",
        "tag_name": "0.11.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.11.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28708141",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.11.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-18T23:26:44Z",
        "datePublished": "2020-07-18T23:27:42Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.10.1",
        "name": "0.10.1",
        "tag_name": "0.10.1",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.10.1",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28706320",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.10.1"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-17T23:35:51Z",
        "datePublished": "2020-07-17T23:36:09Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.10.0",
        "name": "0.10.0",
        "tag_name": "0.10.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.10.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28693835",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.10.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "add `dim_head` keyword for fixing dimension of each head",
        "dateCreated": "2020-07-13T21:48:32Z",
        "datePublished": "2020-07-13T21:49:12Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.9.0",
        "name": "0.9.0",
        "tag_name": "0.9.0",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.9.0",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28520507",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.9.0"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-07T16:37:38Z",
        "datePublished": "2020-07-07T16:37:58Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.8.8",
        "name": "0.8.8",
        "tag_name": "0.8.8",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.8.8",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28322276",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.8.8"
      },
      {
        "authorType": "User",
        "author_name": "lucidrains",
        "body": "",
        "dateCreated": "2020-07-06T16:27:56Z",
        "datePublished": "2020-07-06T16:28:22Z",
        "html_url": "https://github.com/lucidrains/routing-transformer/releases/tag/0.8.7",
        "name": "0.8.7",
        "tag_name": "0.8.7",
        "tarball_url": "https://api.github.com/repos/lucidrains/routing-transformer/tarball/0.8.7",
        "url": "https://api.github.com/repos/lucidrains/routing-transformer/releases/28264620",
        "zipball_url": "https://api.github.com/repos/lucidrains/routing-transformer/zipball/0.8.7"
      }
    ],
    "technique": "GitHub API"
  },
  "stargazers_count": {
    "confidence": [
      1.0
    ],
    "excerpt": {
      "count": 210,
      "date": "Tue, 28 Dec 2021 19:03:11 GMT"
    },
    "technique": "GitHub API"
  },
  "topics": {
    "confidence": [
      1.0
    ],
    "excerpt": [
      "artificial-intelligence",
      "deep-learning",
      "attention-mechanism",
      "transformer",
      "pytorch"
    ],
    "technique": "GitHub API"
  },
  "usage": [
    {
      "confidence": [
        1
      ],
      "excerpt": "A simple language model\n\n```python\nimport torch\nfrom routing_transformer import RoutingTransformerLM\n\nmodel = RoutingTransformerLM(\n    num_tokens = 20000,\n    dim = 512,\n    heads = 8,\n    depth = 12,\n    max_seq_len = 8192,\n    causal = True,           #: auto-regressive or not\n    emb_dim = 128,           #: embedding factorization, from Albert\n    weight_tie = False,      #: weight tie layers, from Albert\n    tie_embedding = False,   #: multiply final embeddings with token weights for logits\n    dim_head = 64,           #: be able to fix the dimension of each head, making it independent of the embedding dimension and the number of heads\n    attn_dropout = 0.1,      #: dropout after attention\n    attn_layer_dropout = 0., #: dropout after self attention layer\n    ff_dropout = 0.1,        #: feedforward dropout\n    layer_dropout = 0.,      #: layer dropout\n    window_size = 128,       #: target window size of each cluster\n    n_local_attn_heads = 4,  #: number of local attention heads\n    reversible = True,       #: reversible networks for memory savings, from Reformer paper\n    ff_chunks = 10,          #: feed forward chunking, from Reformer paper\n    ff_glu = True,           #: use GLU variant in feedforward\n    pkm_layers = (4, 7),     #: specify layers to use product key memory. paper shows 1 or 2 modules near the middle of the transformer is best\n    pkm_num_keys = 128,      #: defaults to 128, but can be increased to 256 or 512 as memory allows\n    moe_layers = (3, 6),     #: specify which layers to use mixture of experts\n    moe_num_experts = 4,     #: number of experts in the mixture of experts layer, defaults to 4. increase for adding more parameters to model\n    moe_loss_coef = 1e-2,    #: the weight for the auxiliary loss in mixture of experts to keep expert usage balanced\n    num_mem_kv = 8,          #: number of memory key/values to append to each cluster of each head, from the 'All-Attention' paper. defaults to 1 in the causal case for unshared QK to work\n    use_scale_norm = False,  #: use scale norm, simplified normalization from 'Transformers without Tears' paper\n    use_rezero = False,      #: use Rezero with no normalization\n    shift_tokens = True      #: shift tokens by one along sequence dimension, for a slight improvement in convergence\n).cuda()\n\nx = torch.randint(0, 20000, (1, 8192)).long().cuda()\ninput_mask = torch.ones_like(x).bool().cuda()\n\ny, aux_loss = model(x, input_mask = input_mask) #: (1, 8192, 20000)\naux_loss.backward() #: add auxiliary loss to main loss before backprop\n```\n\nA simple transformer\n\n```python\nimport torch\nfrom routing_transformer import RoutingTransformer\n\nmodel = RoutingTransformer(\n    dim = 512,\n    heads = 8,\n    depth = 12,\n    max_seq_len = 8192,\n    window_size = 128,\n    n_local_attn_heads = 4\n).cuda()\n\nx = torch.randn(1, 8192, 512).cuda()\ninput_mask = torch.ones(1, 8192).bool().cuda()\n\ny, aux_loss = model(x, input_mask = input_mask) #: (1, 8192, 512)\naux_loss.backward() #: add auxiliary loss to main loss before backprop\n```\n\n",
      "technique": "Header extraction"
    }
  ]
}